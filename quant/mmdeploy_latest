{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "view-in-github",
        "colab_type": "text"
      },
      "source": [
        "<a href=\"https://colab.research.google.com/github/nicefaa6waa/MMPOSE-QUANT/blob/main/quant/mmdeploy_latest\" target=\"_parent\"><img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a>"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "8xX3YewOtqV0"
      },
      "source": [
        "# MMPose Tutorial\n",
        "\n",
        "Welcome to MMPose colab tutorial! In this tutorial, we will show you how to\n",
        "\n",
        "- install MMPose 1.x\n",
        "- perform inference with an MMPose model\n",
        "- train a new mmpose model with your own datasets\n",
        "\n",
        "Let's start!"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "bkw-kUD8t3t8"
      },
      "source": [
        "## Install MMPose\n",
        "\n",
        "We recommend to use a conda environment to install mmpose and its dependencies. And compilers `nvcc` and `gcc` are required."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 1,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "0f_Ebb2otWtd",
        "outputId": "5f8dff61-9254-4505-c008-f4f22f01b917"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "nvcc: NVIDIA (R) Cuda compiler driver\n",
            "Copyright (c) 2005-2024 NVIDIA Corporation\n",
            "Built on Thu_Jun__6_02:18:23_PDT_2024\n",
            "Cuda compilation tools, release 12.5, V12.5.82\n",
            "Build cuda_12.5.r12.5/compiler.34385749_0\n",
            "gcc (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0\n",
            "Copyright (C) 2021 Free Software Foundation, Inc.\n",
            "This is free software; see the source for copying conditions.  There is NO\n",
            "warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n",
            "\n",
            "/usr/local/bin/python\n"
          ]
        }
      ],
      "source": [
        "# check NVCC version\n",
        "!nvcc -V\n",
        "\n",
        "# check GCC version\n",
        "!gcc --version\n",
        "\n",
        "# check python in conda environment\n",
        "!which python"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "%pip install \"numpy<2\""
      ],
      "metadata": {
        "id": "Pa6odVnEbSO_",
        "outputId": "98ad1ad6-a238-4a24-a9ba-79ed3d1f1702",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 411
        }
      },
      "execution_count": 3,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Collecting numpy<2\n",
            "  Downloading numpy-1.26.4-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (61 kB)\n",
            "\u001b[?25l     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m0.0/61.0 kB\u001b[0m \u001b[31m?\u001b[0m eta \u001b[36m-:--:--\u001b[0m\r\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m61.0/61.0 kB\u001b[0m \u001b[31m3.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading numpy-1.26.4-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (18.3 MB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m18.3/18.3 MB\u001b[0m \u001b[31m102.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hInstalling collected packages: numpy\n",
            "  Attempting uninstall: numpy\n",
            "    Found existing installation: numpy 2.0.2\n",
            "    Uninstalling numpy-2.0.2:\n",
            "      Successfully uninstalled numpy-2.0.2\n",
            "\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n",
            "opencv-python 4.12.0.88 requires numpy<2.3.0,>=2; python_version >= \"3.9\", but you have numpy 1.26.4 which is incompatible.\n",
            "opencv-contrib-python 4.12.0.88 requires numpy<2.3.0,>=2; python_version >= \"3.9\", but you have numpy 1.26.4 which is incompatible.\n",
            "thinc 8.3.6 requires numpy<3.0.0,>=2.0.0, but you have numpy 1.26.4 which is incompatible.\n",
            "opencv-python-headless 4.12.0.88 requires numpy<2.3.0,>=2; python_version >= \"3.9\", but you have numpy 1.26.4 which is incompatible.\u001b[0m\u001b[31m\n",
            "\u001b[0mSuccessfully installed numpy-1.26.4\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "application/vnd.colab-display-data+json": {
              "pip_warning": {
                "packages": [
                  "numpy"
                ]
              },
              "id": "36efafa8351140c4aae3701dc5e8bca7"
            }
          },
          "metadata": {}
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "This one is gonna take like 25 minutes"
      ],
      "metadata": {
        "id": "ImCXCN5kcwmg"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 1000
        },
        "id": "igSm4jhihE2M",
        "outputId": "2ea37210-9aad-447f-ff0a-a5d59a7ef48b"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Found existing installation: torch 2.6.0+cu124\n",
            "Uninstalling torch-2.6.0+cu124:\n",
            "  Successfully uninstalled torch-2.6.0+cu124\n",
            "Found existing installation: torchvision 0.21.0+cu124\n",
            "Uninstalling torchvision-0.21.0+cu124:\n",
            "  Successfully uninstalled torchvision-0.21.0+cu124\n",
            "Found existing installation: torchaudio 2.6.0+cu124\n",
            "Uninstalling torchaudio-2.6.0+cu124:\n",
            "  Successfully uninstalled torchaudio-2.6.0+cu124\n",
            "\u001b[33mWARNING: Skipping mmcv as it is not installed.\u001b[0m\u001b[33m\n",
            "\u001b[0m\u001b[33mWARNING: Skipping mmdet as it is not installed.\u001b[0m\u001b[33m\n",
            "\u001b[0m\u001b[33mWARNING: Skipping mmengine as it is not installed.\u001b[0m\u001b[33m\n",
            "\u001b[0mLooking in indexes: https://download.pytorch.org/whl/cu118\n",
            "Collecting torch==2.0.1\n",
            "  Downloading https://download.pytorch.org/whl/cu118/torch-2.0.1%2Bcu118-cp311-cp311-linux_x86_64.whl (2267.3 MB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m2.3/2.3 GB\u001b[0m \u001b[31m448.8 kB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hCollecting torchvision==0.15.2\n",
            "  Downloading https://download.pytorch.org/whl/cu118/torchvision-0.15.2%2Bcu118-cp311-cp311-linux_x86_64.whl (6.1 MB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m6.1/6.1 MB\u001b[0m \u001b[31m111.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hCollecting torchaudio==2.0.2\n",
            "  Downloading https://download.pytorch.org/whl/cu118/torchaudio-2.0.2%2Bcu118-cp311-cp311-linux_x86_64.whl (4.4 MB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m4.4/4.4 MB\u001b[0m \u001b[31m85.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.11/dist-packages (from torch==2.0.1) (3.18.0)\n",
            "Requirement already satisfied: typing-extensions in /usr/local/lib/python3.11/dist-packages (from torch==2.0.1) (4.14.1)\n",
            "Requirement already satisfied: sympy in /usr/local/lib/python3.11/dist-packages (from torch==2.0.1) (1.13.1)\n",
            "Requirement already satisfied: networkx in /usr/local/lib/python3.11/dist-packages (from torch==2.0.1) (3.5)\n",
            "Requirement already satisfied: jinja2 in /usr/local/lib/python3.11/dist-packages (from torch==2.0.1) (3.1.6)\n",
            "Collecting triton==2.0.0 (from torch==2.0.1)\n",
            "  Downloading https://download.pytorch.org/whl/triton-2.0.0-1-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (63.3 MB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m63.3/63.3 MB\u001b[0m \u001b[31m11.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hRequirement already satisfied: numpy in /usr/local/lib/python3.11/dist-packages (from torchvision==0.15.2) (1.26.4)\n",
            "Requirement already satisfied: requests in /usr/local/lib/python3.11/dist-packages (from torchvision==0.15.2) (2.32.3)\n",
            "Requirement already satisfied: pillow!=8.3.*,>=5.3.0 in /usr/local/lib/python3.11/dist-packages (from torchvision==0.15.2) (11.3.0)\n",
            "Requirement already satisfied: cmake in /usr/local/lib/python3.11/dist-packages (from triton==2.0.0->torch==2.0.1) (3.31.6)\n",
            "Collecting lit (from triton==2.0.0->torch==2.0.1)\n",
            "  Downloading https://download.pytorch.org/whl/lit-15.0.7.tar.gz (132 kB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m132.3/132.3 kB\u001b[0m \u001b[31m12.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n",
            "Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.11/dist-packages (from jinja2->torch==2.0.1) (3.0.2)\n",
            "Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.11/dist-packages (from requests->torchvision==0.15.2) (3.4.2)\n",
            "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.11/dist-packages (from requests->torchvision==0.15.2) (3.10)\n",
            "Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests->torchvision==0.15.2) (2.5.0)\n",
            "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.11/dist-packages (from requests->torchvision==0.15.2) (2025.7.14)\n",
            "Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.11/dist-packages (from sympy->torch==2.0.1) (1.3.0)\n",
            "Building wheels for collected packages: lit\n",
            "  Building wheel for lit (setup.py) ... \u001b[?25l\u001b[?25hdone\n",
            "  Created wheel for lit: filename=lit-15.0.7-py3-none-any.whl size=89990 sha256=bd297cfd6c52fe7ee99dc9190cc88d60202eb0a3ac9fb0a59b71159f2d18c597\n",
            "  Stored in directory: /root/.cache/pip/wheels/fc/5d/45/34fe9945d5e45e261134e72284395be36c2d4828af38e2b0fe\n",
            "Successfully built lit\n",
            "Installing collected packages: lit, triton, torch, torchvision, torchaudio\n",
            "  Attempting uninstall: triton\n",
            "    Found existing installation: triton 3.2.0\n",
            "    Uninstalling triton-3.2.0:\n",
            "      Successfully uninstalled triton-3.2.0\n",
            "Successfully installed lit-15.0.7 torch-2.0.1+cu118 torchaudio-2.0.2+cu118 torchvision-0.15.2+cu118 triton-2.0.0\n",
            "Collecting mmengine==0.7.2\n",
            "  Downloading mmengine-0.7.2-py3-none-any.whl.metadata (18 kB)\n",
            "Collecting addict (from mmengine==0.7.2)\n",
            "  Downloading addict-2.4.0-py3-none-any.whl.metadata (1.0 kB)\n",
            "Requirement already satisfied: matplotlib in /usr/local/lib/python3.11/dist-packages (from mmengine==0.7.2) (3.10.0)\n",
            "Requirement already satisfied: numpy in /usr/local/lib/python3.11/dist-packages (from mmengine==0.7.2) (1.26.4)\n",
            "Requirement already satisfied: pyyaml in /usr/local/lib/python3.11/dist-packages (from mmengine==0.7.2) (6.0.2)\n",
            "Requirement already satisfied: rich in /usr/local/lib/python3.11/dist-packages (from mmengine==0.7.2) (13.9.4)\n",
            "Requirement already satisfied: termcolor in /usr/local/lib/python3.11/dist-packages (from mmengine==0.7.2) (3.1.0)\n",
            "Collecting yapf (from mmengine==0.7.2)\n",
            "  Downloading yapf-0.43.0-py3-none-any.whl.metadata (46 kB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m46.8/46.8 kB\u001b[0m \u001b[31m2.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hRequirement already satisfied: opencv-python>=3 in /usr/local/lib/python3.11/dist-packages (from mmengine==0.7.2) (4.12.0.88)\n",
            "Collecting numpy (from mmengine==0.7.2)\n",
            "  Downloading numpy-2.2.6-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (62 kB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m62.0/62.0 kB\u001b[0m \u001b[31m4.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hRequirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine==0.7.2) (1.3.2)\n",
            "Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine==0.7.2) (0.12.1)\n",
            "Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine==0.7.2) (4.59.0)\n",
            "Requirement already satisfied: kiwisolver>=1.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine==0.7.2) (1.4.8)\n",
            "Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine==0.7.2) (25.0)\n",
            "Requirement already satisfied: pillow>=8 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine==0.7.2) (11.3.0)\n",
            "Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine==0.7.2) (3.2.3)\n",
            "Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine==0.7.2) (2.9.0.post0)\n",
            "Requirement already satisfied: markdown-it-py>=2.2.0 in /usr/local/lib/python3.11/dist-packages (from rich->mmengine==0.7.2) (3.0.0)\n",
            "Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /usr/local/lib/python3.11/dist-packages (from rich->mmengine==0.7.2) (2.19.2)\n",
            "Requirement already satisfied: platformdirs>=3.5.1 in /usr/local/lib/python3.11/dist-packages (from yapf->mmengine==0.7.2) (4.3.8)\n",
            "Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.11/dist-packages (from markdown-it-py>=2.2.0->rich->mmengine==0.7.2) (0.1.2)\n",
            "Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.11/dist-packages (from python-dateutil>=2.7->matplotlib->mmengine==0.7.2) (1.17.0)\n",
            "Downloading mmengine-0.7.2-py3-none-any.whl (366 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m366.9/366.9 kB\u001b[0m \u001b[31m18.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading numpy-2.2.6-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (16.8 MB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m16.8/16.8 MB\u001b[0m \u001b[31m115.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading addict-2.4.0-py3-none-any.whl (3.8 kB)\n",
            "Downloading yapf-0.43.0-py3-none-any.whl (256 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m256.2/256.2 kB\u001b[0m \u001b[31m23.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hInstalling collected packages: addict, yapf, numpy, mmengine\n",
            "  Attempting uninstall: numpy\n",
            "    Found existing installation: numpy 1.26.4\n",
            "    Uninstalling numpy-1.26.4:\n",
            "      Successfully uninstalled numpy-1.26.4\n",
            "\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n",
            "tensorflow 2.18.0 requires numpy<2.1.0,>=1.26.0, but you have numpy 2.2.6 which is incompatible.\n",
            "numba 0.60.0 requires numpy<2.1,>=1.22, but you have numpy 2.2.6 which is incompatible.\u001b[0m\u001b[31m\n",
            "\u001b[0mSuccessfully installed addict-2.4.0 mmengine-0.7.2 numpy-2.2.6 yapf-0.43.0\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "application/vnd.colab-display-data+json": {
              "pip_warning": {
                "packages": [
                  "numpy"
                ]
              },
              "id": "5d37e51f4fc14fb69ece7192ce1c0d76"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Looking in links: https://download.openmmlab.com/mmcv/dist/cu118/torch2.0/index.html\n",
            "Collecting mmcv==2.0.0\n",
            "  Downloading https://download.openmmlab.com/mmcv/dist/cu118/torch2.0.0/mmcv-2.0.0-cp311-cp311-manylinux1_x86_64.whl (74.4 MB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m74.4/74.4 MB\u001b[0m \u001b[31m10.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hRequirement already satisfied: addict in /usr/local/lib/python3.11/dist-packages (from mmcv==2.0.0) (2.4.0)\n",
            "Requirement already satisfied: mmengine>=0.2.0 in /usr/local/lib/python3.11/dist-packages (from mmcv==2.0.0) (0.7.2)\n",
            "Requirement already satisfied: numpy in /usr/local/lib/python3.11/dist-packages (from mmcv==2.0.0) (2.2.6)\n",
            "Requirement already satisfied: packaging in /usr/local/lib/python3.11/dist-packages (from mmcv==2.0.0) (25.0)\n",
            "Requirement already satisfied: Pillow in /usr/local/lib/python3.11/dist-packages (from mmcv==2.0.0) (11.3.0)\n",
            "Requirement already satisfied: pyyaml in /usr/local/lib/python3.11/dist-packages (from mmcv==2.0.0) (6.0.2)\n",
            "Requirement already satisfied: yapf in /usr/local/lib/python3.11/dist-packages (from mmcv==2.0.0) (0.43.0)\n",
            "Requirement already satisfied: opencv-python>=3 in /usr/local/lib/python3.11/dist-packages (from mmcv==2.0.0) (4.12.0.88)\n",
            "Requirement already satisfied: matplotlib in /usr/local/lib/python3.11/dist-packages (from mmengine>=0.2.0->mmcv==2.0.0) (3.10.0)\n",
            "Requirement already satisfied: rich in /usr/local/lib/python3.11/dist-packages (from mmengine>=0.2.0->mmcv==2.0.0) (13.9.4)\n",
            "Requirement already satisfied: termcolor in /usr/local/lib/python3.11/dist-packages (from mmengine>=0.2.0->mmcv==2.0.0) (3.1.0)\n",
            "Requirement already satisfied: platformdirs>=3.5.1 in /usr/local/lib/python3.11/dist-packages (from yapf->mmcv==2.0.0) (4.3.8)\n",
            "Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine>=0.2.0->mmcv==2.0.0) (1.3.2)\n",
            "Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine>=0.2.0->mmcv==2.0.0) (0.12.1)\n",
            "Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine>=0.2.0->mmcv==2.0.0) (4.59.0)\n",
            "Requirement already satisfied: kiwisolver>=1.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine>=0.2.0->mmcv==2.0.0) (1.4.8)\n",
            "Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine>=0.2.0->mmcv==2.0.0) (3.2.3)\n",
            "Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine>=0.2.0->mmcv==2.0.0) (2.9.0.post0)\n",
            "Requirement already satisfied: markdown-it-py>=2.2.0 in /usr/local/lib/python3.11/dist-packages (from rich->mmengine>=0.2.0->mmcv==2.0.0) (3.0.0)\n",
            "Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /usr/local/lib/python3.11/dist-packages (from rich->mmengine>=0.2.0->mmcv==2.0.0) (2.19.2)\n",
            "Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.11/dist-packages (from markdown-it-py>=2.2.0->rich->mmengine>=0.2.0->mmcv==2.0.0) (0.1.2)\n",
            "Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.11/dist-packages (from python-dateutil>=2.7->matplotlib->mmengine>=0.2.0->mmcv==2.0.0) (1.17.0)\n",
            "Installing collected packages: mmcv\n",
            "Successfully installed mmcv-2.0.0\n",
            "Collecting mmdet==3.0.0\n",
            "  Downloading mmdet-3.0.0-py3-none-any.whl.metadata (26 kB)\n",
            "Requirement already satisfied: matplotlib in /usr/local/lib/python3.11/dist-packages (from mmdet==3.0.0) (3.10.0)\n",
            "Requirement already satisfied: numpy in /usr/local/lib/python3.11/dist-packages (from mmdet==3.0.0) (2.2.6)\n",
            "Requirement already satisfied: pycocotools in /usr/local/lib/python3.11/dist-packages (from mmdet==3.0.0) (2.0.10)\n",
            "Requirement already satisfied: scipy in /usr/local/lib/python3.11/dist-packages (from mmdet==3.0.0) (1.16.0)\n",
            "Requirement already satisfied: shapely in /usr/local/lib/python3.11/dist-packages (from mmdet==3.0.0) (2.1.1)\n",
            "Requirement already satisfied: six in /usr/local/lib/python3.11/dist-packages (from mmdet==3.0.0) (1.17.0)\n",
            "Collecting terminaltables (from mmdet==3.0.0)\n",
            "  Downloading terminaltables-3.1.10-py2.py3-none-any.whl.metadata (3.5 kB)\n",
            "Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmdet==3.0.0) (1.3.2)\n",
            "Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmdet==3.0.0) (0.12.1)\n",
            "Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmdet==3.0.0) (4.59.0)\n",
            "Requirement already satisfied: kiwisolver>=1.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmdet==3.0.0) (1.4.8)\n",
            "Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmdet==3.0.0) (25.0)\n",
            "Requirement already satisfied: pillow>=8 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmdet==3.0.0) (11.3.0)\n",
            "Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmdet==3.0.0) (3.2.3)\n",
            "Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmdet==3.0.0) (2.9.0.post0)\n",
            "Downloading mmdet-3.0.0-py3-none-any.whl (1.7 MB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.7/1.7 MB\u001b[0m \u001b[31m31.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading terminaltables-3.1.10-py2.py3-none-any.whl (15 kB)\n",
            "Installing collected packages: terminaltables, mmdet\n",
            "Successfully installed mmdet-3.0.0 terminaltables-3.1.10\n",
            "Collecting git+https://github.com/jin-s13/xtcocoapi\n",
            "  Cloning https://github.com/jin-s13/xtcocoapi to /tmp/pip-req-build-c2zh2gzg\n",
            "  Running command git clone --filter=blob:none --quiet https://github.com/jin-s13/xtcocoapi /tmp/pip-req-build-c2zh2gzg\n",
            "  Resolved https://github.com/jin-s13/xtcocoapi to commit d74033ff1635e9002133b2380862bc2b728584d2\n",
            "  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n",
            "Requirement already satisfied: setuptools>=18.0 in /usr/local/lib/python3.11/dist-packages (from xtcocotools==1.14.3) (75.2.0)\n",
            "Requirement already satisfied: cython>=0.27.3 in /usr/local/lib/python3.11/dist-packages (from xtcocotools==1.14.3) (3.0.12)\n",
            "Requirement already satisfied: matplotlib>=2.1.0 in /usr/local/lib/python3.11/dist-packages (from xtcocotools==1.14.3) (3.10.0)\n",
            "Requirement already satisfied: numpy>=1.20.0 in /usr/local/lib/python3.11/dist-packages (from xtcocotools==1.14.3) (2.2.6)\n",
            "Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib>=2.1.0->xtcocotools==1.14.3) (1.3.2)\n",
            "Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.11/dist-packages (from matplotlib>=2.1.0->xtcocotools==1.14.3) (0.12.1)\n",
            "Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.11/dist-packages (from matplotlib>=2.1.0->xtcocotools==1.14.3) (4.59.0)\n",
            "Requirement already satisfied: kiwisolver>=1.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib>=2.1.0->xtcocotools==1.14.3) (1.4.8)\n",
            "Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.11/dist-packages (from matplotlib>=2.1.0->xtcocotools==1.14.3) (25.0)\n",
            "Requirement already satisfied: pillow>=8 in /usr/local/lib/python3.11/dist-packages (from matplotlib>=2.1.0->xtcocotools==1.14.3) (11.3.0)\n",
            "Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib>=2.1.0->xtcocotools==1.14.3) (3.2.3)\n",
            "Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.11/dist-packages (from matplotlib>=2.1.0->xtcocotools==1.14.3) (2.9.0.post0)\n",
            "Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.11/dist-packages (from python-dateutil>=2.7->matplotlib>=2.1.0->xtcocotools==1.14.3) (1.17.0)\n",
            "Building wheels for collected packages: xtcocotools\n",
            "  Building wheel for xtcocotools (setup.py) ... \u001b[?25l\u001b[?25hdone\n",
            "  Created wheel for xtcocotools: filename=xtcocotools-1.14.3-cp311-cp311-linux_x86_64.whl size=400110 sha256=1358f492b06aa06f7d64e92a4de179439f18d5bcee761d21e7231a15530e13b9\n",
            "  Stored in directory: /tmp/pip-ephem-wheel-cache-f0hgfnlb/wheels/5a/ea/c9/3686eb7518a994eb1f23153e762c339458b6428a9b92b4f483\n",
            "Successfully built xtcocotools\n",
            "Installing collected packages: xtcocotools\n",
            "Successfully installed xtcocotools-1.14.3\n",
            "Cloning into 'mmdeploy'...\n",
            "remote: Enumerating objects: 25299, done.\u001b[K\n",
            "remote: Counting objects: 100% (411/411), done.\u001b[K\n",
            "remote: Compressing objects: 100% (263/263), done.\u001b[K\n",
            "remote: Total 25299 (delta 290), reused 148 (delta 148), pack-reused 24888 (from 2)\u001b[K\n",
            "Receiving objects: 100% (25299/25299), 13.59 MiB | 27.73 MiB/s, done.\n",
            "Resolving deltas: 100% (16129/16129), done.\n",
            "Submodule 'third_party/cub' (https://github.com/NVIDIA/cub.git) registered for path 'third_party/cub'\n",
            "Submodule 'third_party/pybind11' (https://github.com/pybind/pybind11.git) registered for path 'third_party/pybind11'\n",
            "Submodule 'third_party/spdlog' (https://github.com/gabime/spdlog.git) registered for path 'third_party/spdlog'\n",
            "Cloning into '/content/mmdeploy/third_party/cub'...\n",
            "remote: Enumerating objects: 33392, done.        \n",
            "remote: Counting objects: 100% (247/247), done.        \n",
            "remote: Compressing objects: 100% (63/63), done.        \n",
            "remote: Total 33392 (delta 209), reused 184 (delta 184), pack-reused 33145 (from 4)        \n",
            "Receiving objects: 100% (33392/33392), 18.00 MiB | 27.80 MiB/s, done.\n",
            "Resolving deltas: 100% (27972/27972), done.\n",
            "Cloning into '/content/mmdeploy/third_party/pybind11'...\n",
            "remote: Enumerating objects: 27855, done.        \n",
            "remote: Counting objects: 100% (173/173), done.        \n",
            "remote: Compressing objects: 100% (112/112), done.        \n",
            "remote: Total 27855 (delta 114), reused 61 (delta 61), pack-reused 27682 (from 3)        \n",
            "Receiving objects: 100% (27855/27855), 12.63 MiB | 26.82 MiB/s, done.\n",
            "Resolving deltas: 100% (19597/19597), done.\n",
            "Cloning into '/content/mmdeploy/third_party/spdlog'...\n",
            "remote: Enumerating objects: 30555, done.        \n",
            "remote: Counting objects: 100% (7834/7834), done.        \n",
            "remote: Compressing objects: 100% (583/583), done.        \n",
            "remote: Total 30555 (delta 7491), reused 7251 (delta 7251), pack-reused 22721 (from 4)        \n",
            "Receiving objects: 100% (30555/30555), 41.29 MiB | 20.45 MiB/s, done.\n",
            "Resolving deltas: 100% (20685/20685), done.\n",
            "Submodule path 'third_party/cub': checked out 'c3cceac115c072fb63df1836ff46d8c60d9eb304'\n",
            "Submodule path 'third_party/pybind11': checked out '1a917f1852eb7819b671fc3fa862840f4c491a07'\n",
            "Submodule path 'third_party/spdlog': checked out '9e8e52c0488706986c76eeb4225286ac02fb1ee9'\n",
            "--2025-07-29 13:49:30--  https://github.com/microsoft/onnxruntime/releases/download/v1.8.1/onnxruntime-linux-x64-1.8.1.tgz\n",
            "Resolving github.com (github.com)... 140.82.116.3\n",
            "Connecting to github.com (github.com)|140.82.116.3|:443... connected.\n",
            "HTTP request sent, awaiting response... 302 Found\n",
            "Location: https://release-assets.githubusercontent.com/github-production-release-asset/156939672/60591b80-deed-11eb-9a7a-0cc5b6ca4d24?sp=r&sv=2018-11-09&sr=b&spr=https&se=2025-07-29T14%3A38%3A11Z&rscd=attachment%3B+filename%3Donnxruntime-linux-x64-1.8.1.tgz&rsct=application%2Foctet-stream&skoid=96c2d410-5711-43a1-aedd-ab1947aa7ab0&sktid=398a6654-997b-47e9-b12b-9515b896b4de&skt=2025-07-29T13%3A38%3A02Z&ske=2025-07-29T14%3A38%3A11Z&sks=b&skv=2018-11-09&sig=IEJ9zF3kz01oQOMHsElUIRoDjf7IilAa1qEa8uTXRz8%3D&jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmVsZWFzZS1hc3NldHMuZ2l0aHVidXNlcmNvbnRlbnQuY29tIiwia2V5Ijoia2V5MSIsImV4cCI6MTc1Mzc5NzI3MCwibmJmIjoxNzUzNzk2OTcwLCJwYXRoIjoicmVsZWFzZWFzc2V0cHJvZHVjdGlvbi5ibG9iLmNvcmUud2luZG93cy5uZXQifQ.800nLPVAwf-oS5OK4cH3-qv_koAJ4h4-7BApcqAwrJ4&response-content-disposition=attachment%3B%20filename%3Donnxruntime-linux-x64-1.8.1.tgz&response-content-type=application%2Foctet-stream [following]\n",
            "--2025-07-29 13:49:30--  https://release-assets.githubusercontent.com/github-production-release-asset/156939672/60591b80-deed-11eb-9a7a-0cc5b6ca4d24?sp=r&sv=2018-11-09&sr=b&spr=https&se=2025-07-29T14%3A38%3A11Z&rscd=attachment%3B+filename%3Donnxruntime-linux-x64-1.8.1.tgz&rsct=application%2Foctet-stream&skoid=96c2d410-5711-43a1-aedd-ab1947aa7ab0&sktid=398a6654-997b-47e9-b12b-9515b896b4de&skt=2025-07-29T13%3A38%3A02Z&ske=2025-07-29T14%3A38%3A11Z&sks=b&skv=2018-11-09&sig=IEJ9zF3kz01oQOMHsElUIRoDjf7IilAa1qEa8uTXRz8%3D&jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmVsZWFzZS1hc3NldHMuZ2l0aHVidXNlcmNvbnRlbnQuY29tIiwia2V5Ijoia2V5MSIsImV4cCI6MTc1Mzc5NzI3MCwibmJmIjoxNzUzNzk2OTcwLCJwYXRoIjoicmVsZWFzZWFzc2V0cHJvZHVjdGlvbi5ibG9iLmNvcmUud2luZG93cy5uZXQifQ.800nLPVAwf-oS5OK4cH3-qv_koAJ4h4-7BApcqAwrJ4&response-content-disposition=attachment%3B%20filename%3Donnxruntime-linux-x64-1.8.1.tgz&response-content-type=application%2Foctet-stream\n",
            "Resolving release-assets.githubusercontent.com (release-assets.githubusercontent.com)... 185.199.108.133, 185.199.109.133, 185.199.110.133, ...\n",
            "Connecting to release-assets.githubusercontent.com (release-assets.githubusercontent.com)|185.199.108.133|:443... connected.\n",
            "HTTP request sent, awaiting response... 200 OK\n",
            "Length: 4736207 (4.5M) [application/octet-stream]\n",
            "Saving to: ‘onnxruntime-linux-x64-1.8.1.tgz’\n",
            "\n",
            "onnxruntime-linux-x 100%[===================>]   4.52M  --.-KB/s    in 0.06s   \n",
            "\n",
            "2025-07-29 13:49:30 (77.8 MB/s) - ‘onnxruntime-linux-x64-1.8.1.tgz’ saved [4736207/4736207]\n",
            "\n",
            "onnxruntime-linux-x64-1.8.1/\n",
            "onnxruntime-linux-x64-1.8.1/ThirdPartyNotices.txt\n",
            "onnxruntime-linux-x64-1.8.1/LICENSE\n",
            "onnxruntime-linux-x64-1.8.1/Privacy.md\n",
            "onnxruntime-linux-x64-1.8.1/README.md\n",
            "onnxruntime-linux-x64-1.8.1/include/\n",
            "onnxruntime-linux-x64-1.8.1/include/onnxruntime_session_options_config_keys.h\n",
            "onnxruntime-linux-x64-1.8.1/include/cpu_provider_factory.h\n",
            "onnxruntime-linux-x64-1.8.1/include/cuda_provider_factory.h\n",
            "onnxruntime-linux-x64-1.8.1/include/provider_options.h\n",
            "onnxruntime-linux-x64-1.8.1/include/onnxruntime_cxx_inline.h\n",
            "onnxruntime-linux-x64-1.8.1/include/onnxruntime_run_options_config_keys.h\n",
            "onnxruntime-linux-x64-1.8.1/include/onnxruntime_c_api.h\n",
            "onnxruntime-linux-x64-1.8.1/include/onnxruntime_cxx_api.h\n",
            "onnxruntime-linux-x64-1.8.1/GIT_COMMIT_ID\n",
            "onnxruntime-linux-x64-1.8.1/lib/\n",
            "onnxruntime-linux-x64-1.8.1/lib/libonnxruntime.so\n",
            "onnxruntime-linux-x64-1.8.1/lib/libonnxruntime.so.1.8.1\n",
            "onnxruntime-linux-x64-1.8.1/VERSION_NUMBER\n",
            "/content/mmdeploy\n",
            "-- CMAKE_INSTALL_PREFIX: /content/mmdeploy/build/install\n",
            "-- The C compiler identification is GNU 11.4.0\n",
            "-- The CXX compiler identification is GNU 11.4.0\n",
            "-- Detecting C compiler ABI info\n",
            "-- Detecting C compiler ABI info - done\n",
            "-- Check for working C compiler: /usr/bin/cc - skipped\n",
            "-- Detecting C compile features\n",
            "-- Detecting C compile features - done\n",
            "-- Detecting CXX compiler ABI info\n",
            "-- Detecting CXX compiler ABI info - done\n",
            "-- Check for working CXX compiler: /usr/bin/c++ - skipped\n",
            "-- Detecting CXX compile features\n",
            "-- Detecting CXX compile features - done\n",
            "-- Build ONNXRUNTIME custom ops.\n",
            "-- Configuring done (0.5s)\n",
            "-- Generating done (0.0s)\n",
            "-- Build files have been written to: /content/mmdeploy/build\n",
            "[ 12%] \u001b[32mBuilding CXX object csrc/mmdeploy/backend_ops/onnxruntime/CMakeFiles/mmdeploy_onnxruntime_ops_obj.dir/common/ort_utils.cpp.o\u001b[0m\n",
            "[ 25%] \u001b[32mBuilding CXX object csrc/mmdeploy/backend_ops/onnxruntime/CMakeFiles/mmdeploy_onnxruntime_ops_obj.dir/grid_sample/grid_sample.cpp.o\u001b[0m\n",
            "[ 37%] \u001b[32mBuilding CXX object csrc/mmdeploy/backend_ops/onnxruntime/CMakeFiles/mmdeploy_onnxruntime_ops_obj.dir/modulated_deform_conv/modulated_deform_conv.cpp.o\u001b[0m\n",
            "[ 50%] \u001b[32mBuilding CXX object csrc/mmdeploy/backend_ops/onnxruntime/CMakeFiles/mmdeploy_onnxruntime_ops_obj.dir/nms_match/nms_match.cpp.o\u001b[0m\n",
            "[ 62%] \u001b[32mBuilding CXX object csrc/mmdeploy/backend_ops/onnxruntime/CMakeFiles/mmdeploy_onnxruntime_ops_obj.dir/nms_rotated/nms_rotated.cpp.o\u001b[0m\n",
            "[ 75%] \u001b[32mBuilding CXX object csrc/mmdeploy/backend_ops/onnxruntime/CMakeFiles/mmdeploy_onnxruntime_ops_obj.dir/onnxruntime_register.cpp.o\u001b[0m\n",
            "[ 87%] \u001b[32mBuilding CXX object csrc/mmdeploy/backend_ops/onnxruntime/CMakeFiles/mmdeploy_onnxruntime_ops_obj.dir/roi_align_rotated/roi_align_rotated.cpp.o\u001b[0m\n",
            "[ 87%] Built target mmdeploy_onnxruntime_ops_obj\n",
            "[100%] \u001b[32m\u001b[1mLinking CXX shared library ../../../../lib/libmmdeploy_onnxruntime_ops.so\u001b[0m\n",
            "[100%] Built target mmdeploy_onnxruntime_ops\n",
            "[ 87%] Built target mmdeploy_onnxruntime_ops_obj\n",
            "[100%] Built target mmdeploy_onnxruntime_ops\n",
            "\u001b[36mInstall the project...\u001b[0m\n",
            "-- Install configuration: \"Release\"\n",
            "-- Installing: /content/mmdeploy/mmdeploy/lib/libmmdeploy_onnxruntime_ops.so\n",
            "-- Set non-toolchain portion of runtime path of \"/content/mmdeploy/mmdeploy/lib/libmmdeploy_onnxruntime_ops.so\" to \"$ORIGIN\"\n",
            "Obtaining file:///content/mmdeploy\n",
            "  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n",
            "Collecting aenum (from mmdeploy==1.3.1)\n",
            "  Downloading aenum-3.1.16-py3-none-any.whl.metadata (3.8 kB)\n",
            "Requirement already satisfied: grpcio in /usr/local/lib/python3.11/dist-packages (from mmdeploy==1.3.1) (1.74.0)\n",
            "Requirement already satisfied: matplotlib in /usr/local/lib/python3.11/dist-packages (from mmdeploy==1.3.1) (3.10.0)\n",
            "Requirement already satisfied: mmengine in /usr/local/lib/python3.11/dist-packages (from mmdeploy==1.3.1) (0.7.2)\n",
            "Requirement already satisfied: multiprocess in /usr/local/lib/python3.11/dist-packages (from mmdeploy==1.3.1) (0.70.16)\n",
            "Requirement already satisfied: numpy in /usr/local/lib/python3.11/dist-packages (from mmdeploy==1.3.1) (2.2.6)\n",
            "Collecting onnx>=1.13.0 (from mmdeploy==1.3.1)\n",
            "  Downloading onnx-1.18.0-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (6.9 kB)\n",
            "Requirement already satisfied: prettytable in /usr/local/lib/python3.11/dist-packages (from mmdeploy==1.3.1) (3.16.0)\n",
            "Collecting protobuf<=3.20.2 (from mmdeploy==1.3.1)\n",
            "  Downloading protobuf-3.20.2-py2.py3-none-any.whl.metadata (720 bytes)\n",
            "Requirement already satisfied: six in /usr/local/lib/python3.11/dist-packages (from mmdeploy==1.3.1) (1.17.0)\n",
            "Requirement already satisfied: terminaltables in /usr/local/lib/python3.11/dist-packages (from mmdeploy==1.3.1) (3.1.10)\n",
            "INFO: pip is looking at multiple versions of onnx to determine which version is compatible with other requirements. This could take a while.\n",
            "Collecting onnx>=1.13.0 (from mmdeploy==1.3.1)\n",
            "  Downloading onnx-1.17.0-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (16 kB)\n",
            "Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmdeploy==1.3.1) (1.3.2)\n",
            "Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmdeploy==1.3.1) (0.12.1)\n",
            "Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmdeploy==1.3.1) (4.59.0)\n",
            "Requirement already satisfied: kiwisolver>=1.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmdeploy==1.3.1) (1.4.8)\n",
            "Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmdeploy==1.3.1) (25.0)\n",
            "Requirement already satisfied: pillow>=8 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmdeploy==1.3.1) (11.3.0)\n",
            "Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmdeploy==1.3.1) (3.2.3)\n",
            "Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmdeploy==1.3.1) (2.9.0.post0)\n",
            "Requirement already satisfied: addict in /usr/local/lib/python3.11/dist-packages (from mmengine->mmdeploy==1.3.1) (2.4.0)\n",
            "Requirement already satisfied: pyyaml in /usr/local/lib/python3.11/dist-packages (from mmengine->mmdeploy==1.3.1) (6.0.2)\n",
            "Requirement already satisfied: rich in /usr/local/lib/python3.11/dist-packages (from mmengine->mmdeploy==1.3.1) (13.9.4)\n",
            "Requirement already satisfied: termcolor in /usr/local/lib/python3.11/dist-packages (from mmengine->mmdeploy==1.3.1) (3.1.0)\n",
            "Requirement already satisfied: yapf in /usr/local/lib/python3.11/dist-packages (from mmengine->mmdeploy==1.3.1) (0.43.0)\n",
            "Requirement already satisfied: opencv-python>=3 in /usr/local/lib/python3.11/dist-packages (from mmengine->mmdeploy==1.3.1) (4.12.0.88)\n",
            "Requirement already satisfied: dill>=0.3.8 in /usr/local/lib/python3.11/dist-packages (from multiprocess->mmdeploy==1.3.1) (0.3.8)\n",
            "Requirement already satisfied: wcwidth in /usr/local/lib/python3.11/dist-packages (from prettytable->mmdeploy==1.3.1) (0.2.13)\n",
            "Requirement already satisfied: markdown-it-py>=2.2.0 in /usr/local/lib/python3.11/dist-packages (from rich->mmengine->mmdeploy==1.3.1) (3.0.0)\n",
            "Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /usr/local/lib/python3.11/dist-packages (from rich->mmengine->mmdeploy==1.3.1) (2.19.2)\n",
            "Requirement already satisfied: platformdirs>=3.5.1 in /usr/local/lib/python3.11/dist-packages (from yapf->mmengine->mmdeploy==1.3.1) (4.3.8)\n",
            "Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.11/dist-packages (from markdown-it-py>=2.2.0->rich->mmengine->mmdeploy==1.3.1) (0.1.2)\n",
            "Downloading onnx-1.17.0-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (16.0 MB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m16.0/16.0 MB\u001b[0m \u001b[31m28.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading protobuf-3.20.2-py2.py3-none-any.whl (162 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m162.1/162.1 kB\u001b[0m \u001b[31m7.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading aenum-3.1.16-py3-none-any.whl (165 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m165.6/165.6 kB\u001b[0m \u001b[31m16.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hInstalling collected packages: aenum, protobuf, onnx, mmdeploy\n",
            "  Attempting uninstall: protobuf\n",
            "    Found existing installation: protobuf 5.29.5\n",
            "    Uninstalling protobuf-5.29.5:\n",
            "      Successfully uninstalled protobuf-5.29.5\n",
            "  Running setup.py develop for mmdeploy\n",
            "\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n",
            "ydf 0.13.0 requires protobuf<7.0.0,>=5.29.1, but you have protobuf 3.20.2 which is incompatible.\n",
            "tensorflow 2.18.0 requires numpy<2.1.0,>=1.26.0, but you have numpy 2.2.6 which is incompatible.\n",
            "tensorflow 2.18.0 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.3, but you have protobuf 3.20.2 which is incompatible.\n",
            "grpcio-status 1.71.2 requires protobuf<6.0dev,>=5.26.1, but you have protobuf 3.20.2 which is incompatible.\n",
            "tensorflow-metadata 1.17.2 requires protobuf>=4.25.2; python_version >= \"3.11\", but you have protobuf 3.20.2 which is incompatible.\u001b[0m\u001b[31m\n",
            "\u001b[0mSuccessfully installed aenum-3.1.16 mmdeploy-1.3.1 onnx-1.17.0 protobuf-3.20.2\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "application/vnd.colab-display-data+json": {
              "pip_warning": {
                "packages": [
                  "google"
                ]
              },
              "id": "588c5ba87c634140b158a683a4063760"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "-- CMAKE_INSTALL_PREFIX: /content/mmdeploy/build/install\n",
            "-- The C compiler identification is GNU 11.4.0\n",
            "-- The CXX compiler identification is GNU 11.4.0\n",
            "-- Detecting C compiler ABI info\n",
            "-- Detecting C compiler ABI info - done\n",
            "-- Check for working C compiler: /usr/bin/cc - skipped\n",
            "-- Detecting C compile features\n",
            "-- Detecting C compile features - done\n",
            "-- Detecting CXX compiler ABI info\n",
            "-- Detecting CXX compiler ABI info - done\n",
            "-- Check for working CXX compiler: /usr/bin/c++ - skipped\n",
            "-- Detecting CXX compile features\n",
            "-- Detecting CXX compile features - done\n",
            "-- Build ONNXRUNTIME custom ops.\n",
            "-- Found OpenCV: /usr (found version \"4.5.4\")\n",
            "-- Build spdlog: 1.10.0\n",
            "-- Performing Test CMAKE_HAVE_LIBC_PTHREAD\n",
            "-- Performing Test CMAKE_HAVE_LIBC_PTHREAD - Success\n",
            "-- Found Threads: TRUE\n",
            "-- Build type: Release\n",
            "-- build codebase: mmcls\n",
            "-- build codebase: mmdet\n",
            "-- build codebase: mmseg\n",
            "-- build codebase: mmocr\n",
            "-- build codebase: mmedit\n",
            "-- build codebase: mmpose\n",
            "-- build codebase: mmrotate\n",
            "-- build codebase: mmaction\n",
            "\u001b[0mCMake Deprecation Warning at third_party/pybind11/CMakeLists.txt:8 (cmake_minimum_required):\n",
            "  Compatibility with CMake < 3.10 will be removed from a future version of\n",
            "  CMake.\n",
            "\n",
            "  Update the VERSION argument <min> value.  Or, use the <min>...<max> syntax\n",
            "  to tell CMake that the project requires at least <min> but has been updated\n",
            "  to work with policies introduced by <max> or earlier.\n",
            "\n",
            "\u001b[0m\n",
            "-- pybind11 v2.11.0 \n",
            "\u001b[33mCMake Warning (dev) at third_party/pybind11/tools/FindPythonLibsNew.cmake:98 (find_package):\n",
            "  Policy CMP0148 is not set: The FindPythonInterp and FindPythonLibs modules\n",
            "  are removed.  Run \"cmake --help-policy CMP0148\" for policy details.  Use\n",
            "  the cmake_policy command to set the policy and suppress this warning.\n",
            "\n",
            "Call Stack (most recent call first):\n",
            "  third_party/pybind11/tools/pybind11Tools.cmake:50 (find_package)\n",
            "  third_party/pybind11/tools/pybind11Common.cmake:188 (include)\n",
            "  third_party/pybind11/CMakeLists.txt:210 (include)\n",
            "This warning is for project developers.  Use -Wno-dev to suppress it.\n",
            "\u001b[0m\n",
            "-- Found PythonInterp: /usr/bin/python3 (found suitable version \"3.11.13\", minimum required is \"3.6\")\n",
            "-- Found PythonLibs: /usr/lib/x86_64-linux-gnu/libpython3.11.so\n",
            "-- Performing Test HAS_FLTO\n",
            "-- Performing Test HAS_FLTO - Success\n",
            "-- Configuring done (3.9s)\n",
            "-- Generating done (0.3s)\n",
            "-- Build files have been written to: /content/mmdeploy/build\n",
            "[  2%] \u001b[32mBuilding CXX object csrc/mmdeploy/core/spdlog/CMakeFiles/spdlog.dir/src/spdlog.cpp.o\u001b[0m\n",
            "[  2%] \u001b[32mBuilding CXX object csrc/mmdeploy/backend_ops/onnxruntime/CMakeFiles/mmdeploy_onnxruntime_ops_obj.dir/common/ort_utils.cpp.o\u001b[0m\n",
            "[  2%] \u001b[32mBuilding CXX object csrc/mmdeploy/backend_ops/onnxruntime/CMakeFiles/mmdeploy_onnxruntime_ops_obj.dir/grid_sample/grid_sample.cpp.o\u001b[0m\n",
            "[  3%] \u001b[32mBuilding CXX object csrc/mmdeploy/backend_ops/onnxruntime/CMakeFiles/mmdeploy_onnxruntime_ops_obj.dir/modulated_deform_conv/modulated_deform_conv.cpp.o\u001b[0m\n",
            "[  3%] \u001b[32mBuilding CXX object csrc/mmdeploy/backend_ops/onnxruntime/CMakeFiles/mmdeploy_onnxruntime_ops_obj.dir/nms_match/nms_match.cpp.o\u001b[0m\n",
            "[  4%] \u001b[32mBuilding CXX object csrc/mmdeploy/backend_ops/onnxruntime/CMakeFiles/mmdeploy_onnxruntime_ops_obj.dir/nms_rotated/nms_rotated.cpp.o\u001b[0m\n",
            "[  4%] \u001b[32mBuilding CXX object csrc/mmdeploy/backend_ops/onnxruntime/CMakeFiles/mmdeploy_onnxruntime_ops_obj.dir/onnxruntime_register.cpp.o\u001b[0m\n",
            "[  4%] \u001b[32mBuilding CXX object csrc/mmdeploy/backend_ops/onnxruntime/CMakeFiles/mmdeploy_onnxruntime_ops_obj.dir/roi_align_rotated/roi_align_rotated.cpp.o\u001b[0m\n",
            "[  4%] Built target mmdeploy_onnxruntime_ops_obj\n",
            "[  4%] \u001b[32mBuilding CXX object csrc/mmdeploy/core/spdlog/CMakeFiles/spdlog.dir/src/stdout_sinks.cpp.o\u001b[0m\n",
            "[  5%] \u001b[32mBuilding CXX object csrc/mmdeploy/core/spdlog/CMakeFiles/spdlog.dir/src/color_sinks.cpp.o\u001b[0m\n",
            "[  5%] \u001b[32mBuilding CXX object csrc/mmdeploy/core/spdlog/CMakeFiles/spdlog.dir/src/file_sinks.cpp.o\u001b[0m\n",
            "[  6%] \u001b[32mBuilding CXX object csrc/mmdeploy/core/spdlog/CMakeFiles/spdlog.dir/src/async.cpp.o\u001b[0m\n",
            "[  6%] \u001b[32mBuilding CXX object csrc/mmdeploy/core/spdlog/CMakeFiles/spdlog.dir/src/cfg.cpp.o\u001b[0m\n",
            "[  7%] \u001b[32mBuilding CXX object csrc/mmdeploy/core/spdlog/CMakeFiles/spdlog.dir/src/fmt.cpp.o\u001b[0m\n",
            "[  7%] \u001b[32m\u001b[1mLinking CXX shared library ../../../../lib/libmmdeploy_onnxruntime_ops.so\u001b[0m\n",
            "[  7%] Built target mmdeploy_onnxruntime_ops\n",
            "[  7%] \u001b[32m\u001b[1mLinking CXX static library ../../../../lib/libspdlog.a\u001b[0m\n",
            "[  7%] Built target spdlog\n",
            "[  7%] \u001b[32mBuilding CXX object csrc/mmdeploy/core/CMakeFiles/mmdeploy_core.dir/device_impl.cpp.o\u001b[0m\n",
            "[  8%] \u001b[32mBuilding CXX object csrc/mmdeploy/core/CMakeFiles/mmdeploy_core.dir/logger.cpp.o\u001b[0m\n",
            "[  8%] \u001b[32mBuilding CXX object csrc/mmdeploy/core/CMakeFiles/mmdeploy_core.dir/mat.cpp.o\u001b[0m\n",
            "[  8%] \u001b[32mBuilding CXX object csrc/mmdeploy/core/CMakeFiles/mmdeploy_core.dir/model.cpp.o\u001b[0m\n",
            "[  9%] \u001b[32mBuilding CXX object csrc/mmdeploy/core/CMakeFiles/mmdeploy_core.dir/module.cpp.o\u001b[0m\n",
            "[  9%] \u001b[32mBuilding CXX object csrc/mmdeploy/core/CMakeFiles/mmdeploy_core.dir/net.cpp.o\u001b[0m\n",
            "[ 10%] \u001b[32mBuilding CXX object csrc/mmdeploy/core/CMakeFiles/mmdeploy_core.dir/operator.cpp.o\u001b[0m\n",
            "[ 10%] \u001b[32mBuilding CXX object csrc/mmdeploy/core/CMakeFiles/mmdeploy_core.dir/status_code.cpp.o\u001b[0m\n",
            "[ 11%] \u001b[32mBuilding CXX object csrc/mmdeploy/core/CMakeFiles/mmdeploy_core.dir/tensor.cpp.o\u001b[0m\n",
            "[ 11%] \u001b[32mBuilding CXX object csrc/mmdeploy/core/CMakeFiles/mmdeploy_core.dir/registry.cpp.o\u001b[0m\n",
            "[ 12%] \u001b[32mBuilding CXX object csrc/mmdeploy/core/CMakeFiles/mmdeploy_core.dir/graph.cpp.o\u001b[0m\n",
            "[ 12%] \u001b[32mBuilding CXX object csrc/mmdeploy/core/CMakeFiles/mmdeploy_core.dir/utils/device_utils.cpp.o\u001b[0m\n",
            "[ 12%] \u001b[32mBuilding CXX object csrc/mmdeploy/core/CMakeFiles/mmdeploy_core.dir/utils/formatter.cpp.o\u001b[0m\n",
            "[ 13%] \u001b[32mBuilding CXX object csrc/mmdeploy/core/CMakeFiles/mmdeploy_core.dir/utils/stacktrace.cpp.o\u001b[0m\n",
            "[ 13%] \u001b[32mBuilding CXX object csrc/mmdeploy/core/CMakeFiles/mmdeploy_core.dir/profiler.cpp.o\u001b[0m\n"
          ]
        }
      ],
      "source": [
        "\n",
        "# 2. Clean install everything:\n",
        "%pip uninstall torch torchvision torchaudio mmcv mmdet mmengine -y\n",
        "\n",
        "# 3. Install PyTorch with CUDA 11.8\n",
        "%pip install torch==2.0.1 torchvision==0.15.2 torchaudio==2.0.2 --index-url https://download.pytorch.org/whl/cu118\n",
        "\n",
        "# 4. Install MM packages\n",
        "%pip install mmengine==0.7.2\n",
        "%pip install mmcv==2.0.0 -f https://download.openmmlab.com/mmcv/dist/cu118/torch2.0/index.html\n",
        "%pip install mmdet==3.0.0\n",
        "\n",
        "\n",
        "# 1. Clone and install xtcocoapi\n",
        "%pip install git+https://github.com/jin-s13/xtcocoapi\n",
        "\n",
        "# 2. Clone MMDeploy\n",
        "!git clone -b main https://github.com/open-mmlab/mmdeploy.git --recursive\n",
        "\n",
        "# 3. Download and extract ONNX Runtime\n",
        "!wget https://github.com/microsoft/onnxruntime/releases/download/v1.8.1/onnxruntime-linux-x64-1.8.1.tgz\n",
        "!tar -zxvf onnxruntime-linux-x64-1.8.1.tgz\n",
        "\n",
        "# 4. Set ONNXRUNTIME_DIR\n",
        "import os\n",
        "onnx_dir = \"/content/onnxruntime-linux-x64-1.8.1\"\n",
        "os.environ[\"ONNXRUNTIME_DIR\"] = onnx_dir\n",
        "os.environ[\"LD_LIBRARY_PATH\"] = f\"{onnx_dir}/lib:\" + os.environ.get(\"LD_LIBRARY_PATH\", \"\")\n",
        "\n",
        "\n",
        "# 5. Build MMDeploy with ONNX backend\n",
        "%cd /content/mmdeploy\n",
        "\n",
        "!rm -rf build && mkdir -p build && cd build && \\\n",
        "cmake .. \\\n",
        "  -DMMDEPLOY_TARGET_BACKENDS=ort \\\n",
        "  -DONNXRUNTIME_DIR={onnx_dir} && \\\n",
        "make -j$(nproc) && make install\n",
        "\n",
        "# 6. Install MMDeploy Python API\n",
        "!pip install -e .\n",
        "\n",
        "\n",
        "# 7. Optional: Build SDK with Python API (no g++-7!)\n",
        "!rm -rf build && mkdir -p build && cd build && \\\n",
        "cmake .. \\\n",
        "  -DMMDEPLOY_BUILD_SDK=ON \\\n",
        "  -DMMDEPLOY_BUILD_SDK_PYTHON_API=ON \\\n",
        "  -DMMDEPLOY_BUILD_EXAMPLES=ON \\\n",
        "  -DMMDEPLOY_TARGET_DEVICES=cpu \\\n",
        "  -DMMDEPLOY_TARGET_BACKENDS=ort \\\n",
        "  -DONNXRUNTIME_DIR={onnx_dir} && \\\n",
        "make -j$(nproc) && make install\n",
        "\n",
        "\n",
        "# 6. Install mmpose\n",
        "!git clone https://github.com/open-mmlab/mmpose.git\n",
        "# The master branch is version 1.x\n",
        "%cd mmpose\n",
        "%pip install -r requirements.txt\n",
        "%pip install -v -e .\n",
        "# \"-v\" means verbose, or more output\n",
        "# \"-e\" means installing a project in editable mode,\n",
        "# thus any local modifications made to the code will take effect without reinstallation.\n",
        "\n",
        "\n",
        "# 7. Check Pytorch installation\n",
        "import torch, torchvision\n",
        "\n",
        "print('torch version:', torch.__version__, torch.cuda.is_available())\n",
        "print('torchvision version:', torchvision.__version__)\n",
        "\n",
        "# Check MMPose installation\n",
        "import mmpose\n",
        "\n",
        "print('mmpose version:', mmpose.__version__)\n",
        "\n",
        "# Check mmcv installation\n",
        "from mmcv.ops import get_compiling_cuda_version, get_compiler_version\n",
        "\n",
        "print('cuda version:', get_compiling_cuda_version())\n",
        "print('compiler information:', get_compiler_version())\n"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "import mmdeploy\n",
        "print(\"MMDeploy installed successfully:\", mmdeploy.__file__)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "yBIzGXLPVdFA",
        "outputId": "e3864b57-629d-4718-cff7-06c1d560c766"
      },
      "execution_count": 16,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "MMDeploy installed successfully: /content/mmdeploy/mmdeploy/__init__.py\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "# 2. Install PPQ for quantization\n",
        "!git clone https://github.com/openppl-public/ppq.git\n",
        "%cd ppq\n",
        "!pip install -r requirements.txt\n",
        "!python setup.py install\n",
        "%cd .."
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "J0pQLaoz-wvM",
        "outputId": "c33f5d59-76f2-439e-958d-369035387077"
      },
      "execution_count": 17,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Cloning into 'ppq'...\n",
            "remote: Enumerating objects: 3868, done.\u001b[K\n",
            "remote: Counting objects: 100% (1176/1176), done.\u001b[K\n",
            "remote: Compressing objects: 100% (247/247), done.\u001b[K\n",
            "remote: Total 3868 (delta 1007), reused 929 (delta 929), pack-reused 2692 (from 1)\u001b[K\n",
            "Receiving objects: 100% (3868/3868), 5.59 MiB | 11.76 MiB/s, done.\n",
            "Resolving deltas: 100% (2675/2675), done.\n",
            "/content/mmdeploy/ppq\n",
            "Requirement already satisfied: numpy in /usr/local/lib/python3.11/dist-packages (from -r requirements.txt (line 1)) (2.0.2)\n",
            "Requirement already satisfied: onnx>=1.9.0 in /usr/local/lib/python3.11/dist-packages (from -r requirements.txt (line 2)) (1.17.0)\n",
            "Requirement already satisfied: protobuf in /usr/local/lib/python3.11/dist-packages (from -r requirements.txt (line 3)) (3.20.2)\n",
            "Requirement already satisfied: torch>=1.6.0 in /usr/local/lib/python3.11/dist-packages (from -r requirements.txt (line 4)) (2.0.1+cu118)\n",
            "Requirement already satisfied: tqdm in /usr/local/lib/python3.11/dist-packages (from -r requirements.txt (line 5)) (4.65.2)\n",
            "Requirement already satisfied: filelock in /usr/local/lib/python3.11/dist-packages (from torch>=1.6.0->-r requirements.txt (line 4)) (3.14.0)\n",
            "Requirement already satisfied: typing-extensions in /usr/local/lib/python3.11/dist-packages (from torch>=1.6.0->-r requirements.txt (line 4)) (4.14.1)\n",
            "Requirement already satisfied: sympy in /usr/local/lib/python3.11/dist-packages (from torch>=1.6.0->-r requirements.txt (line 4)) (1.13.1)\n",
            "Requirement already satisfied: networkx in /usr/local/lib/python3.11/dist-packages (from torch>=1.6.0->-r requirements.txt (line 4)) (3.5)\n",
            "Requirement already satisfied: jinja2 in /usr/local/lib/python3.11/dist-packages (from torch>=1.6.0->-r requirements.txt (line 4)) (3.1.6)\n",
            "Requirement already satisfied: triton==2.0.0 in /usr/local/lib/python3.11/dist-packages (from torch>=1.6.0->-r requirements.txt (line 4)) (2.0.0)\n",
            "Requirement already satisfied: cmake in /usr/local/lib/python3.11/dist-packages (from triton==2.0.0->torch>=1.6.0->-r requirements.txt (line 4)) (3.31.6)\n",
            "Requirement already satisfied: lit in /usr/local/lib/python3.11/dist-packages (from triton==2.0.0->torch>=1.6.0->-r requirements.txt (line 4)) (15.0.7)\n",
            "Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.11/dist-packages (from jinja2->torch>=1.6.0->-r requirements.txt (line 4)) (3.0.2)\n",
            "Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.11/dist-packages (from sympy->torch>=1.6.0->-r requirements.txt (line 4)) (1.3.0)\n",
            "/content/mmdeploy/ppq/ppq/__init__.py:10: UserWarning: You are importing ppq within its own root folder (/content/mmdeploy/ppq). \n",
            "  warnings.warn(message.format(os.getcwd()))\n",
            "No CUDA runtime is found, using CUDA_HOME='/usr/local/cuda'\n",
            "\n",
            "      ____  ____  __   ____                    __              __\n",
            "     / __ \\/ __ \\/ /  / __ \\__  ______ _____  / /_____  ____  / /\n",
            "    / /_/ / /_/ / /  / / / / / / / __ `/ __ \\/ __/ __ \\/ __ \\/ /\n",
            "   / ____/ ____/ /__/ /_/ / /_/ / /_/ / / / / /_/ /_/ / /_/ / /\n",
            "  /_/   /_/   /_____\\___\\_\\__,_/\\__,_/_/ /_/\\__/\\____/\\____/_/\n",
            "\n",
            "\n",
            "running install\n",
            "/usr/local/lib/python3.11/dist-packages/setuptools/command/install.py:34: SetuptoolsDeprecationWarning: setup.py install is deprecated. Use build and pip and other standards-based tools.\n",
            "  warnings.warn(\n",
            "/usr/local/lib/python3.11/dist-packages/setuptools/command/easy_install.py:156: EasyInstallDeprecationWarning: easy_install command is deprecated. Use build and pip and other standards-based tools.\n",
            "  warnings.warn(\n",
            "running bdist_egg\n",
            "running egg_info\n",
            "creating ppq.egg-info\n",
            "writing manifest file 'ppq.egg-info/SOURCES.txt'\n",
            "writing manifest file 'ppq.egg-info/SOURCES.txt'\n",
            "running install_lib\n",
            "running build_py\n",
            "creating build\n",
            "creating build/lib\n",
            "creating build/lib/tests\n",
            "copying tests/test_cuda_kernel.py -> build/lib/tests\n",
            "copying tests/testBnToConv.py -> build/lib/tests\n",
            "copying tests/test_block.py -> build/lib/tests\n",
            "copying tests/test_gemm_fusion.py -> build/lib/tests\n",
            "copying tests/test_layerwise_equalization.py -> build/lib/tests\n",
            "copying tests/test_graph_api.py -> build/lib/tests\n",
            "copying tests/test_onnxruntime.py -> build/lib/tests\n",
            "copying tests/test_system.py -> build/lib/tests\n",
            "copying tests/test_rounding.py -> build/lib/tests\n",
            "copying tests/testFuseBias.py -> build/lib/tests\n",
            "copying tests/test_block_split.py -> build/lib/tests\n",
            "copying tests/test_isotone.py -> build/lib/tests\n",
            "copying tests/test_activation_fusion.py -> build/lib/tests\n",
            "copying tests/test_gemm_split.py -> build/lib/tests\n",
            "copying tests/test_persus.py -> build/lib/tests\n",
            "copying tests/__init__.py -> build/lib/tests\n",
            "creating build/lib/ppq\n",
            "copying ppq/__init__.py -> build/lib/ppq\n",
            "creating build/lib/tests/tmodel\n",
            "copying tests/tmodel/base.py -> build/lib/tests/tmodel\n",
            "copying tests/tmodel/__init__.py -> build/lib/tests/tmodel\n",
            "creating build/lib/tests/tscheme\n",
            "copying tests/tscheme/base.py -> build/lib/tests/tscheme\n",
            "copying tests/tscheme/__init__.py -> build/lib/tests/tscheme\n",
            "creating build/lib/tests/tmodel/testblocks\n",
            "copying tests/tmodel/testblocks/blocks.py -> build/lib/tests/tmodel/testblocks\n",
            "copying tests/tmodel/testblocks/__init__.py -> build/lib/tests/tmodel/testblocks\n",
            "creating build/lib/tests/tmodel/torchmodels\n",
            "copying tests/tmodel/torchmodels/__init__.py -> build/lib/tests/tmodel/torchmodels\n",
            "creating build/lib/ppq/parser\n",
            "copying ppq/parser/onnx_parser.py -> build/lib/ppq/parser\n",
            "copying ppq/parser/mnn_exporter.py -> build/lib/ppq/parser\n",
            "copying ppq/parser/onnx_exporter.py -> build/lib/ppq/parser\n",
            "copying ppq/parser/native.py -> build/lib/ppq/parser\n",
            "copying ppq/parser/extension.py -> build/lib/ppq/parser\n",
            "copying ppq/parser/util.py -> build/lib/ppq/parser\n",
            "copying ppq/parser/caffe_parser.py -> build/lib/ppq/parser\n",
            "copying ppq/parser/ppl.py -> build/lib/ppq/parser\n",
            "copying ppq/parser/nxp_exporter.py -> build/lib/ppq/parser\n",
            "copying ppq/parser/ncnn_exporter.py -> build/lib/ppq/parser\n",
            "copying ppq/parser/caffe_exporter.py -> build/lib/ppq/parser\n",
            "copying ppq/parser/qnn_exporter.py -> build/lib/ppq/parser\n",
            "copying ppq/parser/openvino_exporter.py -> build/lib/ppq/parser\n",
            "copying ppq/parser/tengine_exporter.py -> build/lib/ppq/parser\n",
            "copying ppq/parser/onnxruntime_exporter.py -> build/lib/ppq/parser\n",
            "copying ppq/parser/tensorRT.py -> build/lib/ppq/parser\n",
            "copying ppq/parser/ascend_export.py -> build/lib/ppq/parser\n",
            "copying ppq/parser/__init__.py -> build/lib/ppq/parser\n",
            "creating build/lib/ppq/api\n",
            "copying ppq/api/fsys.py -> build/lib/ppq/api\n",
            "copying ppq/api/interface.py -> build/lib/ppq/api\n",
            "copying ppq/api/setting.py -> build/lib/ppq/api\n",
            "copying ppq/api/__init__.py -> build/lib/ppq/api\n",
            "creating build/lib/ppq/IR\n",
            "copying ppq/IR/quantize.py -> build/lib/ppq/IR\n",
            "copying ppq/IR/training.py -> build/lib/ppq/IR\n",
            "copying ppq/IR/search.py -> build/lib/ppq/IR\n",
            "copying ppq/IR/processer.py -> build/lib/ppq/IR\n",
            "copying ppq/IR/morph.py -> build/lib/ppq/IR\n",
            "copying ppq/IR/deploy.py -> build/lib/ppq/IR\n",
            "copying ppq/IR/__init__.py -> build/lib/ppq/IR\n",
            "creating build/lib/ppq/scheduler\n",
            "copying ppq/scheduler/allin.py -> build/lib/ppq/scheduler\n",
            "copying ppq/scheduler/perseus.py -> build/lib/ppq/scheduler\n",
            "copying ppq/scheduler/dispatchers.py -> build/lib/ppq/scheduler\n",
            "copying ppq/scheduler/base.py -> build/lib/ppq/scheduler\n",
            "copying ppq/scheduler/__init__.py -> build/lib/ppq/scheduler\n",
            "creating build/lib/ppq/core\n",
            "copying ppq/core/common.py -> build/lib/ppq/core\n",
            "copying ppq/core/quant.py -> build/lib/ppq/core\n",
            "copying ppq/core/storage.py -> build/lib/ppq/core\n",
            "copying ppq/core/config.py -> build/lib/ppq/core\n",
            "copying ppq/core/data.py -> build/lib/ppq/core\n",
            "copying ppq/core/defs.py -> build/lib/ppq/core\n",
            "copying ppq/core/ffi.py -> build/lib/ppq/core\n",
            "copying ppq/core/__init__.py -> build/lib/ppq/core\n",
            "creating build/lib/ppq/utils\n",
            "copying ppq/utils/TensorRTUtil.py -> build/lib/ppq/utils\n",
            "copying ppq/utils/write_qparams_onnx2trt.py -> build/lib/ppq/utils\n",
            "copying ppq/utils/ema.py -> build/lib/ppq/utils\n",
            "copying ppq/utils/OnnxruntimeUtil.py -> build/lib/ppq/utils\n",
            "copying ppq/utils/fetch.py -> build/lib/ppq/utils\n",
            "copying ppq/utils/round.py -> build/lib/ppq/utils\n",
            "copying ppq/utils/OpenvinoUtil.py -> build/lib/ppq/utils\n",
            "copying ppq/utils/write_qparams_to_snpe_dlc.py -> build/lib/ppq/utils\n",
            "copying ppq/utils/attribute.py -> build/lib/ppq/utils\n",
            "copying ppq/utils/write_qparams_caffe2trt.py -> build/lib/ppq/utils\n",
            "copying ppq/utils/__init__.py -> build/lib/ppq/utils\n",
            "copying ppq/utils/graph_editor.py -> build/lib/ppq/utils\n",
            "creating build/lib/ppq/quantization\n",
            "copying ppq/quantization/__init__.py -> build/lib/ppq/quantization\n",
            "creating build/lib/ppq/log\n",
            "copying ppq/log/logger.py -> build/lib/ppq/log\n",
            "copying ppq/log/__init__.py -> build/lib/ppq/log\n",
            "creating build/lib/ppq/lib\n",
            "copying ppq/lib/common.py -> build/lib/ppq/lib\n",
            "copying ppq/lib/extension.py -> build/lib/ppq/lib\n",
            "copying ppq/lib/quant.py -> build/lib/ppq/lib\n",
            "copying ppq/lib/__init__.py -> build/lib/ppq/lib\n",
            "creating build/lib/ppq/executor\n",
            "copying ppq/executor/torch.py -> build/lib/ppq/executor\n",
            "copying ppq/executor/base.py -> build/lib/ppq/executor\n",
            "copying ppq/executor/__init__.py -> build/lib/ppq/executor\n",
            "creating build/lib/ppq/parser/caffe\n",
            "copying ppq/parser/caffe/caffe_import_utils.py -> build/lib/ppq/parser/caffe\n",
            "copying ppq/parser/caffe/caffe_export_utils.py -> build/lib/ppq/parser/caffe\n",
            "copying ppq/parser/caffe/ppl_caffe_pb2.py -> build/lib/ppq/parser/caffe\n",
            "copying ppq/parser/caffe/caffe_graph_optim.py -> build/lib/ppq/parser/caffe\n",
            "copying ppq/parser/caffe/__init__.py -> build/lib/ppq/parser/caffe\n",
            "creating build/lib/ppq/IR/base\n",
            "copying ppq/IR/base/graph.py -> build/lib/ppq/IR/base\n",
            "copying ppq/IR/base/command.py -> build/lib/ppq/IR/base\n",
            "copying ppq/IR/base/opdef.py -> build/lib/ppq/IR/base\n",
            "copying ppq/IR/base/__init__.py -> build/lib/ppq/IR/base\n",
            "creating build/lib/ppq/quantization/measure\n",
            "copying ppq/quantization/measure/cosine.py -> build/lib/ppq/quantization/measure\n",
            "copying ppq/quantization/measure/statistic.py -> build/lib/ppq/quantization/measure\n",
            "copying ppq/quantization/measure/norm.py -> build/lib/ppq/quantization/measure\n",
            "copying ppq/quantization/measure/__init__.py -> build/lib/ppq/quantization/measure\n",
            "creating build/lib/ppq/quantization/qfunction\n",
            "copying ppq/quantization/qfunction/floating.py -> build/lib/ppq/quantization/qfunction\n",
            "copying ppq/quantization/qfunction/linear.py -> build/lib/ppq/quantization/qfunction\n",
            "copying ppq/quantization/qfunction/base.py -> build/lib/ppq/quantization/qfunction\n",
            "copying ppq/quantization/qfunction/__init__.py -> build/lib/ppq/quantization/qfunction\n",
            "creating build/lib/ppq/quantization/analyse\n",
            "copying ppq/quantization/analyse/graphwise.py -> build/lib/ppq/quantization/analyse\n",
            "copying ppq/quantization/analyse/layerwise.py -> build/lib/ppq/quantization/analyse\n",
            "copying ppq/quantization/analyse/__init__.py -> build/lib/ppq/quantization/analyse\n",
            "creating build/lib/ppq/quantization/observer\n",
            "copying ppq/quantization/observer/floating.py -> build/lib/ppq/quantization/observer\n",
            "copying ppq/quantization/observer/range.py -> build/lib/ppq/quantization/observer\n",
            "copying ppq/quantization/observer/order.py -> build/lib/ppq/quantization/observer\n",
            "copying ppq/quantization/observer/base.py -> build/lib/ppq/quantization/observer\n",
            "copying ppq/quantization/observer/__init__.py -> build/lib/ppq/quantization/observer\n",
            "creating build/lib/ppq/quantization/quantizer\n",
            "copying ppq/quantization/quantizer/MyQuantizer.py -> build/lib/ppq/quantization/quantizer\n",
            "copying ppq/quantization/quantizer/PPLQuantizer.py -> build/lib/ppq/quantization/quantizer\n",
            "copying ppq/quantization/quantizer/FPGAQuantizer.py -> build/lib/ppq/quantization/quantizer\n",
            "copying ppq/quantization/quantizer/OpenvinoQuantizer.py -> build/lib/ppq/quantization/quantizer\n",
            "copying ppq/quantization/quantizer/RKNNQuantizer.py -> build/lib/ppq/quantization/quantizer\n",
            "copying ppq/quantization/quantizer/DSPQuantizer.py -> build/lib/ppq/quantization/quantizer\n",
            "copying ppq/quantization/quantizer/NCNNQuantizer.py -> build/lib/ppq/quantization/quantizer\n",
            "copying ppq/quantization/quantizer/MetaxQuantizer.py -> build/lib/ppq/quantization/quantizer\n",
            "copying ppq/quantization/quantizer/TensorRTQuantizer.py -> build/lib/ppq/quantization/quantizer\n",
            "copying ppq/quantization/quantizer/MNNQuantizer.py -> build/lib/ppq/quantization/quantizer\n",
            "copying ppq/quantization/quantizer/TengineQuantizer.py -> build/lib/ppq/quantization/quantizer\n",
            "copying ppq/quantization/quantizer/ORTQuantizer.py -> build/lib/ppq/quantization/quantizer\n",
            "copying ppq/quantization/quantizer/NXPQuantizer.py -> build/lib/ppq/quantization/quantizer\n",
            "copying ppq/quantization/quantizer/FP8Quantizer.py -> build/lib/ppq/quantization/quantizer\n",
            "copying ppq/quantization/quantizer/AscendQuantizer.py -> build/lib/ppq/quantization/quantizer\n",
            "copying ppq/quantization/quantizer/base.py -> build/lib/ppq/quantization/quantizer\n",
            "copying ppq/quantization/quantizer/__init__.py -> build/lib/ppq/quantization/quantizer\n",
            "creating build/lib/ppq/quantization/optim\n",
            "copying ppq/quantization/optim/parameters.py -> build/lib/ppq/quantization/optim\n",
            "copying ppq/quantization/optim/equalization.py -> build/lib/ppq/quantization/optim\n",
            "copying ppq/quantization/optim/extension.py -> build/lib/ppq/quantization/optim\n",
            "copying ppq/quantization/optim/ssd.py -> build/lib/ppq/quantization/optim\n",
            "copying ppq/quantization/optim/baking.py -> build/lib/ppq/quantization/optim\n",
            "copying ppq/quantization/optim/training.py -> build/lib/ppq/quantization/optim\n",
            "copying ppq/quantization/optim/legacy.py -> build/lib/ppq/quantization/optim\n",
            "copying ppq/quantization/optim/morph.py -> build/lib/ppq/quantization/optim\n",
            "copying ppq/quantization/optim/refine.py -> build/lib/ppq/quantization/optim\n",
            "copying ppq/quantization/optim/exprimental.py -> build/lib/ppq/quantization/optim\n",
            "copying ppq/quantization/optim/calibration.py -> build/lib/ppq/quantization/optim\n",
            "copying ppq/quantization/optim/base.py -> build/lib/ppq/quantization/optim\n",
            "copying ppq/quantization/optim/__init__.py -> build/lib/ppq/quantization/optim\n",
            "creating build/lib/ppq/quantization/algorithm\n",
            "copying ppq/quantization/algorithm/equalization.py -> build/lib/ppq/quantization/algorithm\n",
            "copying ppq/quantization/algorithm/training.py -> build/lib/ppq/quantization/algorithm\n",
            "copying ppq/quantization/algorithm/exprimental.py -> build/lib/ppq/quantization/algorithm\n",
            "copying ppq/quantization/algorithm/__init__.py -> build/lib/ppq/quantization/algorithm\n",
            "creating build/lib/ppq/quantization/analyse/util\n",
            "copying ppq/quantization/analyse/util/__init__.py -> build/lib/ppq/quantization/analyse/util\n",
            "creating build/lib/ppq/executor/op\n",
            "copying ppq/executor/op/__init__.py -> build/lib/ppq/executor/op\n",
            "creating build/lib/ppq/executor/op/torch\n",
            "copying ppq/executor/op/torch/default.py -> build/lib/ppq/executor/op/torch\n",
            "copying ppq/executor/op/torch/extension.py -> build/lib/ppq/executor/op/torch\n",
            "copying ppq/executor/op/torch/nxp.py -> build/lib/ppq/executor/op/torch\n",
            "copying ppq/executor/op/torch/onnx.py -> build/lib/ppq/executor/op/torch\n",
            "copying ppq/executor/op/torch/academic.py -> build/lib/ppq/executor/op/torch\n",
            "copying ppq/executor/op/torch/cuda.py -> build/lib/ppq/executor/op/torch\n",
            "copying ppq/executor/op/torch/base.py -> build/lib/ppq/executor/op/torch\n",
            "copying ppq/executor/op/torch/dsp.py -> build/lib/ppq/executor/op/torch\n",
            "copying ppq/executor/op/torch/__init__.py -> build/lib/ppq/executor/op/torch\n",
            "creating build/lib/ppq/csrc\n",
            "copying ppq/csrc/export.cc -> build/lib/ppq/csrc\n",
            "creating build/lib/ppq/csrc/build\n",
            "copying ppq/csrc/build/readme.md -> build/lib/ppq/csrc/build\n",
            "creating build/lib/ppq/csrc/cpu\n",
            "copying ppq/csrc/cpu/common.h -> build/lib/ppq/csrc/cpu\n",
            "copying ppq/csrc/cpu/hist_mse.cc -> build/lib/ppq/csrc/cpu\n",
            "copying ppq/csrc/cpu/hist_mse.h -> build/lib/ppq/csrc/cpu\n",
            "creating build/lib/ppq/csrc/cuda\n",
            "copying ppq/csrc/cuda/PPQ.h -> build/lib/ppq/csrc/cuda\n",
            "copying ppq/csrc/cuda/common.cuh -> build/lib/ppq/csrc/cuda\n",
            "copying ppq/csrc/cuda/common.h -> build/lib/ppq/csrc/cuda\n",
            "copying ppq/csrc/cuda/floating.cu -> build/lib/ppq/csrc/cuda\n",
            "copying ppq/csrc/cuda/floating.h -> build/lib/ppq/csrc/cuda\n",
            "copying ppq/csrc/cuda/isotone.cc -> build/lib/ppq/csrc/cuda\n",
            "copying ppq/csrc/cuda/isotone.h -> build/lib/ppq/csrc/cuda\n",
            "copying ppq/csrc/cuda/linear.cu -> build/lib/ppq/csrc/cuda\n",
            "copying ppq/csrc/cuda/linear.h -> build/lib/ppq/csrc/cuda\n",
            "copying ppq/csrc/cuda/sort.cu -> build/lib/ppq/csrc/cuda\n",
            "copying ppq/csrc/cuda/sort.h -> build/lib/ppq/csrc/cuda\n",
            "copying ppq/csrc/cuda/test.cu -> build/lib/ppq/csrc/cuda\n",
            "copying ppq/csrc/cuda/test.h -> build/lib/ppq/csrc/cuda\n",
            "copying ppq/csrc/cuda/train.cu -> build/lib/ppq/csrc/cuda\n",
            "copying ppq/csrc/cuda/train.h -> build/lib/ppq/csrc/cuda\n",
            "copying ppq/parser/caffe/caffe.proto -> build/lib/ppq/parser/caffe\n",
            "creating build/bdist.linux-x86_64\n",
            "creating build/bdist.linux-x86_64/egg\n",
            "creating build/bdist.linux-x86_64/egg/tests\n",
            "creating build/bdist.linux-x86_64/egg/tests/tmodel\n",
            "creating build/bdist.linux-x86_64/egg/tests/tmodel/testblocks\n",
            "creating build/bdist.linux-x86_64/egg/tests/tmodel/torchmodels\n",
            "creating build/bdist.linux-x86_64/egg/tests/tscheme\n",
            "creating build/bdist.linux-x86_64/egg/ppq\n",
            "creating build/bdist.linux-x86_64/egg/ppq/parser\n",
            "creating build/bdist.linux-x86_64/egg/ppq/parser/caffe\n",
            "creating build/bdist.linux-x86_64/egg/ppq/api\n",
            "creating build/bdist.linux-x86_64/egg/ppq/IR\n",
            "creating build/bdist.linux-x86_64/egg/ppq/IR/base\n",
            "creating build/bdist.linux-x86_64/egg/ppq/scheduler\n",
            "creating build/bdist.linux-x86_64/egg/ppq/core\n",
            "creating build/bdist.linux-x86_64/egg/ppq/utils\n",
            "creating build/bdist.linux-x86_64/egg/ppq/csrc\n",
            "creating build/bdist.linux-x86_64/egg/ppq/csrc/cuda\n",
            "creating build/bdist.linux-x86_64/egg/ppq/csrc/cpu\n",
            "creating build/bdist.linux-x86_64/egg/ppq/csrc/build\n",
            "creating build/bdist.linux-x86_64/egg/ppq/quantization\n",
            "creating build/bdist.linux-x86_64/egg/ppq/quantization/measure\n",
            "creating build/bdist.linux-x86_64/egg/ppq/quantization/qfunction\n",
            "creating build/bdist.linux-x86_64/egg/ppq/quantization/analyse\n",
            "creating build/bdist.linux-x86_64/egg/ppq/quantization/analyse/util\n",
            "creating build/bdist.linux-x86_64/egg/ppq/quantization/observer\n",
            "creating build/bdist.linux-x86_64/egg/ppq/quantization/quantizer\n",
            "creating build/bdist.linux-x86_64/egg/ppq/quantization/optim\n",
            "creating build/bdist.linux-x86_64/egg/ppq/quantization/algorithm\n",
            "creating build/bdist.linux-x86_64/egg/ppq/log\n",
            "creating build/bdist.linux-x86_64/egg/ppq/lib\n",
            "creating build/bdist.linux-x86_64/egg/ppq/executor\n",
            "creating build/bdist.linux-x86_64/egg/ppq/executor/op\n",
            "creating build/bdist.linux-x86_64/egg/ppq/executor/op/torch\n",
            "byte-compiling build/bdist.linux-x86_64/egg/tests/test_cuda_kernel.py to test_cuda_kernel.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/tests/testBnToConv.py to testBnToConv.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/tests/test_block.py to test_block.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/tests/test_gemm_fusion.py to test_gemm_fusion.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/tests/test_layerwise_equalization.py to test_layerwise_equalization.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/tests/test_graph_api.py to test_graph_api.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/tests/test_onnxruntime.py to test_onnxruntime.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/tests/test_system.py to test_system.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/tests/test_rounding.py to test_rounding.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/tests/tmodel/testblocks/blocks.py to blocks.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/tests/tmodel/testblocks/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/tests/tmodel/torchmodels/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/tests/tmodel/base.py to base.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/tests/tmodel/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/tests/testFuseBias.py to testFuseBias.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/tests/test_block_split.py to test_block_split.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/tests/test_isotone.py to test_isotone.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/tests/test_activation_fusion.py to test_activation_fusion.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/tests/test_gemm_split.py to test_gemm_split.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/tests/test_persus.py to test_persus.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/tests/tscheme/base.py to base.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/tests/tscheme/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/tests/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/parser/onnx_parser.py to onnx_parser.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/parser/mnn_exporter.py to mnn_exporter.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/parser/onnx_exporter.py to onnx_exporter.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/parser/native.py to native.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/parser/extension.py to extension.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/parser/util.py to util.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/parser/caffe_parser.py to caffe_parser.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/parser/ppl.py to ppl.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/parser/nxp_exporter.py to nxp_exporter.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/parser/ncnn_exporter.py to ncnn_exporter.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/parser/caffe_exporter.py to caffe_exporter.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/parser/qnn_exporter.py to qnn_exporter.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/parser/openvino_exporter.py to openvino_exporter.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/parser/tengine_exporter.py to tengine_exporter.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/parser/onnxruntime_exporter.py to onnxruntime_exporter.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/parser/tensorRT.py to tensorRT.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/parser/ascend_export.py to ascend_export.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/parser/caffe/caffe_import_utils.py to caffe_import_utils.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/parser/caffe/caffe_export_utils.py to caffe_export_utils.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/parser/caffe/ppl_caffe_pb2.py to ppl_caffe_pb2.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/parser/caffe/caffe_graph_optim.py to caffe_graph_optim.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/parser/caffe/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/parser/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/api/fsys.py to fsys.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/api/interface.py to interface.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/api/setting.py to setting.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/api/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/IR/quantize.py to quantize.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/IR/training.py to training.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/IR/search.py to search.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/IR/processer.py to processer.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/IR/morph.py to morph.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/IR/deploy.py to deploy.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/IR/base/graph.py to graph.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/IR/base/command.py to command.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/IR/base/opdef.py to opdef.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/IR/base/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/IR/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/scheduler/allin.py to allin.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/scheduler/perseus.py to perseus.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/scheduler/dispatchers.py to dispatchers.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/scheduler/base.py to base.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/scheduler/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/core/common.py to common.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/core/quant.py to quant.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/core/storage.py to storage.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/core/config.py to config.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/core/data.py to data.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/core/defs.py to defs.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/core/ffi.py to ffi.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/core/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/utils/TensorRTUtil.py to TensorRTUtil.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/utils/write_qparams_onnx2trt.py to write_qparams_onnx2trt.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/utils/ema.py to ema.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/utils/OnnxruntimeUtil.py to OnnxruntimeUtil.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/utils/fetch.py to fetch.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/utils/round.py to round.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/utils/OpenvinoUtil.py to OpenvinoUtil.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/utils/write_qparams_to_snpe_dlc.py to write_qparams_to_snpe_dlc.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/utils/attribute.py to attribute.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/utils/write_qparams_caffe2trt.py to write_qparams_caffe2trt.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/utils/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/utils/graph_editor.py to graph_editor.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/measure/cosine.py to cosine.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/measure/statistic.py to statistic.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/measure/norm.py to norm.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/measure/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/qfunction/floating.py to floating.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/qfunction/linear.py to linear.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/qfunction/base.py to base.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/qfunction/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/analyse/graphwise.py to graphwise.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/analyse/layerwise.py to layerwise.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/analyse/util/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/analyse/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/observer/floating.py to floating.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/observer/range.py to range.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/observer/order.py to order.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/observer/base.py to base.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/observer/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/quantizer/MyQuantizer.py to MyQuantizer.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/quantizer/PPLQuantizer.py to PPLQuantizer.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/quantizer/FPGAQuantizer.py to FPGAQuantizer.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/quantizer/OpenvinoQuantizer.py to OpenvinoQuantizer.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/quantizer/RKNNQuantizer.py to RKNNQuantizer.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/quantizer/DSPQuantizer.py to DSPQuantizer.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/quantizer/NCNNQuantizer.py to NCNNQuantizer.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/quantizer/MetaxQuantizer.py to MetaxQuantizer.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/quantizer/TensorRTQuantizer.py to TensorRTQuantizer.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/quantizer/MNNQuantizer.py to MNNQuantizer.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/quantizer/TengineQuantizer.py to TengineQuantizer.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/quantizer/ORTQuantizer.py to ORTQuantizer.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/quantizer/NXPQuantizer.py to NXPQuantizer.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/quantizer/FP8Quantizer.py to FP8Quantizer.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/quantizer/AscendQuantizer.py to AscendQuantizer.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/quantizer/base.py to base.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/quantizer/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/optim/parameters.py to parameters.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/optim/equalization.py to equalization.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/optim/extension.py to extension.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/optim/ssd.py to ssd.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/optim/baking.py to baking.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/optim/training.py to training.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/optim/legacy.py to legacy.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/optim/morph.py to morph.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/optim/refine.py to refine.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/optim/exprimental.py to exprimental.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/optim/calibration.py to calibration.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/optim/base.py to base.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/optim/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/algorithm/equalization.py to equalization.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/algorithm/training.py to training.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/algorithm/exprimental.py to exprimental.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/algorithm/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/quantization/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/log/logger.py to logger.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/log/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/lib/common.py to common.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/lib/extension.py to extension.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/lib/quant.py to quant.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/lib/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/executor/torch.py to torch.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/executor/op/torch/default.py to default.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/executor/op/torch/extension.py to extension.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/executor/op/torch/nxp.py to nxp.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/executor/op/torch/onnx.py to onnx.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/executor/op/torch/academic.py to academic.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/executor/op/torch/cuda.py to cuda.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/executor/op/torch/base.py to base.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/executor/op/torch/dsp.py to dsp.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/executor/op/torch/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/executor/op/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/executor/base.py to base.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/executor/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling build/bdist.linux-x86_64/egg/ppq/__init__.py to __init__.cpython-311.pyc\n",
            "creating build/bdist.linux-x86_64/egg/EGG-INFO\n",
            "copying ppq.egg-info/PKG-INFO -> build/bdist.linux-x86_64/egg/EGG-INFO\n",
            "copying ppq.egg-info/SOURCES.txt -> build/bdist.linux-x86_64/egg/EGG-INFO\n",
            "copying ppq.egg-info/dependency_links.txt -> build/bdist.linux-x86_64/egg/EGG-INFO\n",
            "copying ppq.egg-info/not-zip-safe -> build/bdist.linux-x86_64/egg/EGG-INFO\n",
            "copying ppq.egg-info/requires.txt -> build/bdist.linux-x86_64/egg/EGG-INFO\n",
            "copying ppq.egg-info/top_level.txt -> build/bdist.linux-x86_64/egg/EGG-INFO\n",
            "creating dist\n",
            "removing 'build/bdist.linux-x86_64/egg' (and everything under it)\n",
            "creating /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg\n",
            "Extracting ppq-0.6.6-py3.11.egg to /usr/local/lib/python3.11/dist-packages\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/IR/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/IR/deploy.py to deploy.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/IR/morph.py to morph.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/IR/processer.py to processer.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/IR/quantize.py to quantize.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/IR/search.py to search.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/IR/training.py to training.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/IR/base/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/IR/base/command.py to command.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/IR/base/graph.py to graph.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/IR/base/opdef.py to opdef.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/api/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/api/fsys.py to fsys.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/api/interface.py to interface.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/api/setting.py to setting.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/core/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/core/common.py to common.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/core/config.py to config.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/core/data.py to data.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/core/defs.py to defs.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/core/ffi.py to ffi.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/core/quant.py to quant.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/core/storage.py to storage.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/executor/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/executor/base.py to base.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/executor/torch.py to torch.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/executor/op/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/executor/op/torch/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/executor/op/torch/academic.py to academic.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/executor/op/torch/base.py to base.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/executor/op/torch/cuda.py to cuda.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/executor/op/torch/default.py to default.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/executor/op/torch/dsp.py to dsp.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/executor/op/torch/extension.py to extension.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/executor/op/torch/nxp.py to nxp.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/executor/op/torch/onnx.py to onnx.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/lib/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/lib/common.py to common.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/lib/extension.py to extension.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/lib/quant.py to quant.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/log/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/log/logger.py to logger.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/parser/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/parser/ascend_export.py to ascend_export.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/parser/caffe_exporter.py to caffe_exporter.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/parser/caffe_parser.py to caffe_parser.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/parser/extension.py to extension.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/parser/mnn_exporter.py to mnn_exporter.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/parser/native.py to native.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/parser/ncnn_exporter.py to ncnn_exporter.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/parser/nxp_exporter.py to nxp_exporter.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/parser/onnx_exporter.py to onnx_exporter.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/parser/onnx_parser.py to onnx_parser.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/parser/onnxruntime_exporter.py to onnxruntime_exporter.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/parser/openvino_exporter.py to openvino_exporter.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/parser/ppl.py to ppl.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/parser/qnn_exporter.py to qnn_exporter.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/parser/tengine_exporter.py to tengine_exporter.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/parser/tensorRT.py to tensorRT.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/parser/util.py to util.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/parser/caffe/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/parser/caffe/caffe_export_utils.py to caffe_export_utils.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/parser/caffe/caffe_graph_optim.py to caffe_graph_optim.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/parser/caffe/caffe_import_utils.py to caffe_import_utils.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/parser/caffe/ppl_caffe_pb2.py to ppl_caffe_pb2.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/algorithm/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/algorithm/equalization.py to equalization.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/algorithm/exprimental.py to exprimental.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/algorithm/training.py to training.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/analyse/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/analyse/graphwise.py to graphwise.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/analyse/layerwise.py to layerwise.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/analyse/util/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/measure/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/measure/cosine.py to cosine.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/measure/norm.py to norm.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/measure/statistic.py to statistic.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/observer/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/observer/base.py to base.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/observer/floating.py to floating.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/observer/order.py to order.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/observer/range.py to range.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/optim/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/optim/baking.py to baking.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/optim/base.py to base.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/optim/calibration.py to calibration.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/optim/equalization.py to equalization.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/optim/exprimental.py to exprimental.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/optim/extension.py to extension.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/optim/legacy.py to legacy.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/optim/morph.py to morph.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/optim/parameters.py to parameters.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/optim/refine.py to refine.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/optim/ssd.py to ssd.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/optim/training.py to training.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/qfunction/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/qfunction/base.py to base.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/qfunction/floating.py to floating.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/qfunction/linear.py to linear.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/quantizer/AscendQuantizer.py to AscendQuantizer.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/quantizer/DSPQuantizer.py to DSPQuantizer.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/quantizer/FP8Quantizer.py to FP8Quantizer.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/quantizer/FPGAQuantizer.py to FPGAQuantizer.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/quantizer/MNNQuantizer.py to MNNQuantizer.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/quantizer/MetaxQuantizer.py to MetaxQuantizer.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/quantizer/MyQuantizer.py to MyQuantizer.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/quantizer/NCNNQuantizer.py to NCNNQuantizer.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/quantizer/NXPQuantizer.py to NXPQuantizer.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/quantizer/ORTQuantizer.py to ORTQuantizer.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/quantizer/OpenvinoQuantizer.py to OpenvinoQuantizer.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/quantizer/PPLQuantizer.py to PPLQuantizer.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/quantizer/RKNNQuantizer.py to RKNNQuantizer.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/quantizer/TengineQuantizer.py to TengineQuantizer.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/quantizer/TensorRTQuantizer.py to TensorRTQuantizer.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/quantizer/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/quantization/quantizer/base.py to base.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/scheduler/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/scheduler/allin.py to allin.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/scheduler/base.py to base.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/scheduler/dispatchers.py to dispatchers.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/scheduler/perseus.py to perseus.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/utils/OnnxruntimeUtil.py to OnnxruntimeUtil.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/utils/OpenvinoUtil.py to OpenvinoUtil.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/utils/TensorRTUtil.py to TensorRTUtil.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/utils/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/utils/attribute.py to attribute.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/utils/ema.py to ema.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/utils/fetch.py to fetch.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/utils/graph_editor.py to graph_editor.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/utils/round.py to round.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/utils/write_qparams_caffe2trt.py to write_qparams_caffe2trt.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/utils/write_qparams_onnx2trt.py to write_qparams_onnx2trt.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/ppq/utils/write_qparams_to_snpe_dlc.py to write_qparams_to_snpe_dlc.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/tests/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/tests/testBnToConv.py to testBnToConv.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/tests/testFuseBias.py to testFuseBias.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/tests/test_activation_fusion.py to test_activation_fusion.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/tests/test_block.py to test_block.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/tests/test_block_split.py to test_block_split.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/tests/test_cuda_kernel.py to test_cuda_kernel.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/tests/test_gemm_fusion.py to test_gemm_fusion.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/tests/test_gemm_split.py to test_gemm_split.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/tests/test_graph_api.py to test_graph_api.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/tests/test_isotone.py to test_isotone.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/tests/test_layerwise_equalization.py to test_layerwise_equalization.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/tests/test_onnxruntime.py to test_onnxruntime.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/tests/test_persus.py to test_persus.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/tests/test_rounding.py to test_rounding.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/tests/test_system.py to test_system.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/tests/tmodel/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/tests/tmodel/base.py to base.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/tests/tmodel/testblocks/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/tests/tmodel/testblocks/blocks.py to blocks.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/tests/tmodel/torchmodels/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/tests/tscheme/__init__.py to __init__.cpython-311.pyc\n",
            "byte-compiling /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg/tests/tscheme/base.py to base.cpython-311.pyc\n",
            "Adding ppq 0.6.6 to easy-install.pth file\n",
            "\n",
            "Installed /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg\n",
            "Processing dependencies for ppq==0.6.6\n",
            "Searching for tqdm==4.65.2\n",
            "Best match: tqdm 4.65.2\n",
            "Adding tqdm 4.65.2 to easy-install.pth file\n",
            "Installing tqdm script to /usr/local/bin\n",
            "\n",
            "Using /usr/local/lib/python3.11/dist-packages\n",
            "Searching for torch==2.0.1+cu118\n",
            "Best match: torch 2.0.1+cu118\n",
            "Adding torch 2.0.1+cu118 to easy-install.pth file\n",
            "Installing convert-caffe2-to-onnx script to /usr/local/bin\n",
            "Installing convert-onnx-to-caffe2 script to /usr/local/bin\n",
            "Installing torchrun script to /usr/local/bin\n",
            "\n",
            "Using /usr/local/lib/python3.11/dist-packages\n",
            "Searching for protobuf==3.20.2\n",
            "Best match: protobuf 3.20.2\n",
            "Adding protobuf 3.20.2 to easy-install.pth file\n",
            "\n",
            "Using /usr/local/lib/python3.11/dist-packages\n",
            "Searching for onnx==1.17.0\n",
            "Best match: onnx 1.17.0\n",
            "Adding onnx 1.17.0 to easy-install.pth file\n",
            "Installing backend-test-tools script to /usr/local/bin\n",
            "Installing check-model script to /usr/local/bin\n",
            "Installing check-node script to /usr/local/bin\n",
            "\n",
            "Using /usr/local/lib/python3.11/dist-packages\n",
            "Searching for numpy==2.0.2\n",
            "Best match: numpy 2.0.2\n",
            "Adding numpy 2.0.2 to easy-install.pth file\n",
            "Installing f2py script to /usr/local/bin\n",
            "Installing numpy-config script to /usr/local/bin\n",
            "\n",
            "Using /usr/local/lib/python3.11/dist-packages\n",
            "Searching for typing-extensions==4.14.1\n",
            "Best match: typing-extensions 4.14.1\n",
            "Adding typing-extensions 4.14.1 to easy-install.pth file\n",
            "\n",
            "Using /usr/local/lib/python3.11/dist-packages\n",
            "Searching for sympy==1.13.1\n",
            "Best match: sympy 1.13.1\n",
            "Adding sympy 1.13.1 to easy-install.pth file\n",
            "Installing isympy script to /usr/local/bin\n",
            "\n",
            "Using /usr/local/lib/python3.11/dist-packages\n",
            "Searching for networkx==3.5\n",
            "Best match: networkx 3.5\n",
            "Adding networkx 3.5 to easy-install.pth file\n",
            "\n",
            "Using /usr/local/lib/python3.11/dist-packages\n",
            "Searching for jinja2==3.1.6\n",
            "Best match: jinja2 3.1.6\n",
            "Adding jinja2 3.1.6 to easy-install.pth file\n",
            "\n",
            "Using /usr/local/lib/python3.11/dist-packages\n",
            "Searching for filelock==3.14.0\n",
            "Best match: filelock 3.14.0\n",
            "Adding filelock 3.14.0 to easy-install.pth file\n",
            "\n",
            "Using /usr/local/lib/python3.11/dist-packages\n",
            "Searching for triton==2.0.0\n",
            "Best match: triton 2.0.0\n",
            "Adding triton 2.0.0 to easy-install.pth file\n",
            "\n",
            "Using /usr/local/lib/python3.11/dist-packages\n",
            "Searching for mpmath==1.3.0\n",
            "Best match: mpmath 1.3.0\n",
            "Adding mpmath 1.3.0 to easy-install.pth file\n",
            "\n",
            "Using /usr/local/lib/python3.11/dist-packages\n",
            "Searching for MarkupSafe==3.0.2\n",
            "Best match: MarkupSafe 3.0.2\n",
            "Adding MarkupSafe 3.0.2 to easy-install.pth file\n",
            "\n",
            "Using /usr/local/lib/python3.11/dist-packages\n",
            "Searching for lit==15.0.7\n",
            "Best match: lit 15.0.7\n",
            "Adding lit 15.0.7 to easy-install.pth file\n",
            "Installing lit script to /usr/local/bin\n",
            "\n",
            "Using /usr/local/lib/python3.11/dist-packages\n",
            "Searching for cmake==3.31.6\n",
            "Best match: cmake 3.31.6\n",
            "Adding cmake 3.31.6 to easy-install.pth file\n",
            "Installing ccmake script to /usr/local/bin\n",
            "Installing cmake script to /usr/local/bin\n",
            "Installing cpack script to /usr/local/bin\n",
            "Installing ctest script to /usr/local/bin\n",
            "\n",
            "Using /usr/local/lib/python3.11/dist-packages\n",
            "Finished processing dependencies for ppq==0.6.6\n",
            "/content/mmdeploy\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "# Create data directory structure\n",
        "!mkdir -p /content/data/coco/images\n",
        "!mkdir -p /content/data/coco/annotations\n",
        "\n",
        "# Download COCO validation images (smaller subset for calibration)\n",
        "%cd /content/data/coco/images\n",
        "\n",
        "# Download COCO 2017 validation set (you can use train set too, but val is smaller)\n",
        "!wget http://images.cocodataset.org/zips/val2017.zip\n",
        "!unzip -q val2017.zip\n",
        "!rm val2017.zip\n",
        "\n",
        "print(\"✅ COCO validation images downloaded\")\n",
        "\n",
        "# Download COCO annotations\n",
        "%cd /content/data/coco/annotations\n",
        "\n",
        "!wget http://images.cocodataset.org/annotations/annotations_trainval2017.zip\n",
        "!unzip -q annotations_trainval2017.zip\n",
        "!rm annotations_trainval2017.zip\n",
        "\n",
        "%cd /content\n",
        "\n",
        "print(\"✅ COCO annotations downloaded\")"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "KY-ahHiBaS3I",
        "outputId": "88e5fc18-3608-4faf-eec0-c5d532f5c979"
      },
      "execution_count": 18,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "/content/data/coco/images\n",
            "--2025-07-29 13:19:36--  http://images.cocodataset.org/zips/val2017.zip\n",
            "Resolving images.cocodataset.org (images.cocodataset.org)... 3.5.28.155, 54.231.134.41, 16.182.43.25, ...\n",
            "Connecting to images.cocodataset.org (images.cocodataset.org)|3.5.28.155|:80... connected.\n",
            "HTTP request sent, awaiting response... 200 OK\n",
            "Length: 815585330 (778M) [application/zip]\n",
            "Saving to: ‘val2017.zip’\n",
            "\n",
            "val2017.zip         100%[===================>] 777.80M  82.1MB/s    in 8.7s    \n",
            "\n",
            "2025-07-29 13:19:45 (89.7 MB/s) - ‘val2017.zip’ saved [815585330/815585330]\n",
            "\n",
            "✅ COCO validation images downloaded\n",
            "/content/data/coco/annotations\n",
            "--2025-07-29 13:19:56--  http://images.cocodataset.org/annotations/annotations_trainval2017.zip\n",
            "Resolving images.cocodataset.org (images.cocodataset.org)... 52.217.167.129, 52.217.205.57, 3.5.0.204, ...\n",
            "Connecting to images.cocodataset.org (images.cocodataset.org)|52.217.167.129|:80... connected.\n",
            "HTTP request sent, awaiting response... 200 OK\n",
            "Length: 252907541 (241M) [application/zip]\n",
            "Saving to: ‘annotations_trainval2017.zip’\n",
            "\n",
            "annotations_trainva 100%[===================>] 241.19M  96.4MB/s    in 2.5s    \n",
            "\n",
            "2025-07-29 13:19:58 (96.4 MB/s) - ‘annotations_trainval2017.zip’ saved [252907541/252907541]\n",
            "\n",
            "/content\n",
            "✅ COCO annotations downloaded\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "import random\n",
        "import os\n",
        "import shutil\n",
        "from pathlib import Path\n",
        "import glob\n",
        "\n",
        "def prepare_coco_calibration_dataset(coco_images_dir, output_dir, num_images=200):\n",
        "    \"\"\"\n",
        "    Prepare calibration dataset from COCO validation images\n",
        "\n",
        "    Args:\n",
        "        coco_images_dir: Path to COCO images directory\n",
        "        output_dir: Directory to save calibration images\n",
        "        num_images: Number of images to use for calibration\n",
        "    \"\"\"\n",
        "\n",
        "    # Create output directory\n",
        "    Path(output_dir).mkdir(parents=True, exist_ok=True)\n",
        "\n",
        "    # Get all COCO validation images\n",
        "    coco_images = glob.glob(os.path.join(coco_images_dir, \"val2017\", \"*.jpg\"))\n",
        "\n",
        "    if not coco_images:\n",
        "        print(f\"❌ No images found in {coco_images_dir}/val2017/\")\n",
        "        return\n",
        "\n",
        "    # Randomly select images for calibration\n",
        "    random.seed(42)  # For reproducibility\n",
        "    selected_images = random.sample(coco_images, min(num_images, len(coco_images)))\n",
        "\n",
        "    # Copy selected images to calibration directory\n",
        "    for i, img_path in enumerate(selected_images):\n",
        "        filename = f\"coco_calib_{i:04d}.jpg\"\n",
        "        target_path = os.path.join(output_dir, filename)\n",
        "        shutil.copy2(img_path, target_path)\n",
        "\n",
        "    print(f\"✅ Prepared {len(selected_images)} calibration images in {output_dir}\")\n",
        "    return len(selected_images)\n",
        "\n",
        "# Prepare calibration dataset\n",
        "calibration_dir = \"/content/calibration_images\"\n",
        "num_calib_images = prepare_coco_calibration_dataset(\n",
        "    \"/content/data/coco/images\",\n",
        "    calibration_dir,\n",
        "    num_images=200\n",
        ")"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "AuKcYVdsaXsq",
        "outputId": "c7fe7146-88fa-4914-aa89-0bc045c8cb2d"
      },
      "execution_count": 4,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "✅ Prepared 200 calibration images in /content/calibration_images\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "# Define paths for DEKR HRNet model\n",
        "MODEL_CONFIG = \"/content/mmpose/configs/body_2d_keypoint/dekr/coco/dekr_hrnet-w32_8xb10-140e_coco-512x512.py\"\n",
        "MODEL_URL = \"https://download.openmmlab.com/mmpose/v1/body_2d_keypoint/dekr/coco/dekr_hrnet-w32_8xb10-140e_coco-512x512_ac7c17bf-20221228.pth\"\n",
        "MODEL_PATH = \"/content/dekr_hrnet-w32_8xb10-140e_coco-512x512_ac7c17bf-20221228.pth\"\n",
        "TEST_IMAGE = \"/content/data/coco/images/val2017/000000000139.jpg\"  # Sample COCO image\n",
        "WORK_DIR = \"/content/quantized_dekr_model\"\n",
        "\n",
        "# Download the model if not exists\n",
        "if not os.path.exists(MODEL_PATH):\n",
        "    !wget -O $MODEL_PATH $MODEL_URL\n",
        "    print(f\"✅ Model downloaded: {MODEL_PATH}\")\n",
        "else:\n",
        "    print(f\"✅ Model already exists: {MODEL_PATH}\")\n",
        "\n",
        "# Verify test image exists\n",
        "if not os.path.exists(TEST_IMAGE):\n",
        "    # Use any available COCO image as test image\n",
        "    available_images = glob.glob(\"/content/data/coco/images/val2017/*.jpg\")\n",
        "    if available_images:\n",
        "        TEST_IMAGE = available_images[0]\n",
        "        print(f\"✅ Using test image: {TEST_IMAGE}\")\n",
        "    else:\n",
        "        print(\"❌ No test images found\")\n",
        "\n",
        "print(\"\\n\" + \"=\"*60)\n",
        "print(\"📋 CONFIGURATION SUMMARY\")\n",
        "print(\"=\"*60)\n",
        "print(f\"Model Config: {MODEL_CONFIG}\")\n",
        "print(f\"Model Path: {MODEL_PATH}\")\n",
        "print(f\"Test Image: {TEST_IMAGE}\")\n",
        "print(f\"Calibration Dir: {calibration_dir}\")\n",
        "print(f\"Calibration Images: {num_calib_images}\")\n",
        "print(f\"Work Dir: {WORK_DIR}\")\n",
        "print(\"=\"*60)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "yrQb7yPWagHD",
        "outputId": "4462220c-8c2b-42a4-d465-379a22497059"
      },
      "execution_count": 5,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "✅ Model already exists: /content/dekr_hrnet-w32_8xb10-140e_coco-512x512_ac7c17bf-20221228.pth\n",
            "\n",
            "============================================================\n",
            "📋 CONFIGURATION SUMMARY\n",
            "============================================================\n",
            "Model Config: /content/mmpose/configs/body_2d_keypoint/dekr/coco/dekr_hrnet-w32_8xb10-140e_coco-512x512.py\n",
            "Model Path: /content/dekr_hrnet-w32_8xb10-140e_coco-512x512_ac7c17bf-20221228.pth\n",
            "Test Image: /content/data/coco/images/val2017/000000000139.jpg\n",
            "Calibration Dir: /content/calibration_images\n",
            "Calibration Images: 200\n",
            "Work Dir: /content/quantized_dekr_model\n",
            "============================================================\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "!git clone https://github.com/open-mmlab/mmpose.git\n",
        "# The master branch is version 1.x\n",
        "%cd mmpose\n",
        "%pip install -r requirements.txt\n",
        "%pip install -v -e ."
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "9CFCr6ciW3iO",
        "outputId": "1b6370cc-f582-4b7f-b25c-f20d96e21837"
      },
      "execution_count": 27,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Cloning into 'mmpose'...\n",
            "remote: Enumerating objects: 31261, done.\u001b[K\n",
            "remote: Counting objects: 100% (176/176), done.\u001b[K\n",
            "remote: Compressing objects: 100% (103/103), done.\u001b[K\n",
            "remote: Total 31261 (delta 119), reused 73 (delta 73), pack-reused 31085 (from 2)\u001b[K\n",
            "Receiving objects: 100% (31261/31261), 53.49 MiB | 30.98 MiB/s, done.\n",
            "Resolving deltas: 100% (22000/22000), done.\n",
            "/content/mmdeploy/mmpose\n",
            "\u001b[33mDEPRECATION: Loading egg at /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg is deprecated. pip 24.3 will enforce this behaviour change. A possible replacement is to use pip for package installation. Discussion can be found at https://github.com/pypa/pip/issues/12330\u001b[0m\u001b[33m\n",
            "\u001b[0mRequirement already satisfied: numpy in /usr/local/lib/python3.11/dist-packages (from -r requirements/build.txt (line 2)) (2.0.2)\n",
            "Requirement already satisfied: torch>=1.8 in /usr/local/lib/python3.11/dist-packages (from -r requirements/build.txt (line 3)) (2.0.1+cu118)\n",
            "Collecting chumpy (from -r requirements/runtime.txt (line 1))\n",
            "  Downloading chumpy-0.70.tar.gz (50 kB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m50.6/50.6 kB\u001b[0m \u001b[31m2.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n",
            "Collecting json_tricks (from -r requirements/runtime.txt (line 2))\n",
            "  Downloading json_tricks-3.17.3-py2.py3-none-any.whl.metadata (16 kB)\n",
            "Requirement already satisfied: matplotlib in /usr/local/lib/python3.11/dist-packages (from -r requirements/runtime.txt (line 3)) (3.10.0)\n",
            "Collecting munkres (from -r requirements/runtime.txt (line 4))\n",
            "  Downloading munkres-1.1.4-py2.py3-none-any.whl.metadata (980 bytes)\n",
            "Requirement already satisfied: opencv-python in /usr/local/lib/python3.11/dist-packages (from -r requirements/runtime.txt (line 6)) (4.12.0.88)\n",
            "Requirement already satisfied: pillow in /usr/local/lib/python3.11/dist-packages (from -r requirements/runtime.txt (line 7)) (11.3.0)\n",
            "Requirement already satisfied: scipy in /usr/local/lib/python3.11/dist-packages (from -r requirements/runtime.txt (line 8)) (1.16.0)\n",
            "Requirement already satisfied: torchvision in /usr/local/lib/python3.11/dist-packages (from -r requirements/runtime.txt (line 9)) (0.15.2+cu118)\n",
            "Requirement already satisfied: xtcocotools>=1.12 in /usr/local/lib/python3.11/dist-packages (from -r requirements/runtime.txt (line 10)) (1.14.3)\n",
            "Collecting coverage (from -r requirements/tests.txt (line 1))\n",
            "  Downloading coverage-7.10.1-cp311-cp311-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl.metadata (8.9 kB)\n",
            "Collecting flake8 (from -r requirements/tests.txt (line 2))\n",
            "  Downloading flake8-7.3.0-py2.py3-none-any.whl.metadata (3.8 kB)\n",
            "Collecting interrogate (from -r requirements/tests.txt (line 3))\n",
            "  Downloading interrogate-1.7.0-py3-none-any.whl.metadata (37 kB)\n",
            "Collecting isort==4.3.21 (from -r requirements/tests.txt (line 4))\n",
            "  Downloading isort-4.3.21-py2.py3-none-any.whl.metadata (19 kB)\n",
            "Collecting parameterized (from -r requirements/tests.txt (line 5))\n",
            "  Downloading parameterized-0.9.0-py2.py3-none-any.whl.metadata (18 kB)\n",
            "Requirement already satisfied: pytest in /usr/local/lib/python3.11/dist-packages (from -r requirements/tests.txt (line 6)) (8.4.1)\n",
            "Collecting pytest-runner (from -r requirements/tests.txt (line 7))\n",
            "  Downloading pytest_runner-6.0.1-py3-none-any.whl.metadata (7.3 kB)\n",
            "Collecting xdoctest>=0.10.0 (from -r requirements/tests.txt (line 8))\n",
            "  Downloading xdoctest-1.2.0-py3-none-any.whl.metadata (37 kB)\n",
            "Requirement already satisfied: yapf in /usr/local/lib/python3.11/dist-packages (from -r requirements/tests.txt (line 9)) (0.43.0)\n",
            "Requirement already satisfied: requests in /usr/local/lib/python3.11/dist-packages (from -r requirements/optional.txt (line 1)) (2.28.2)\n",
            "Requirement already satisfied: filelock in /usr/local/lib/python3.11/dist-packages (from torch>=1.8->-r requirements/build.txt (line 3)) (3.14.0)\n",
            "Requirement already satisfied: typing-extensions in /usr/local/lib/python3.11/dist-packages (from torch>=1.8->-r requirements/build.txt (line 3)) (4.14.1)\n",
            "Requirement already satisfied: sympy in /usr/local/lib/python3.11/dist-packages (from torch>=1.8->-r requirements/build.txt (line 3)) (1.13.1)\n",
            "Requirement already satisfied: networkx in /usr/local/lib/python3.11/dist-packages (from torch>=1.8->-r requirements/build.txt (line 3)) (3.5)\n",
            "Requirement already satisfied: jinja2 in /usr/local/lib/python3.11/dist-packages (from torch>=1.8->-r requirements/build.txt (line 3)) (3.1.6)\n",
            "Requirement already satisfied: triton==2.0.0 in /usr/local/lib/python3.11/dist-packages (from torch>=1.8->-r requirements/build.txt (line 3)) (2.0.0)\n",
            "Requirement already satisfied: cmake in /usr/local/lib/python3.11/dist-packages (from triton==2.0.0->torch>=1.8->-r requirements/build.txt (line 3)) (3.31.6)\n",
            "Requirement already satisfied: lit in /usr/local/lib/python3.11/dist-packages (from triton==2.0.0->torch>=1.8->-r requirements/build.txt (line 3)) (15.0.7)\n",
            "Requirement already satisfied: six>=1.11.0 in /usr/local/lib/python3.11/dist-packages (from chumpy->-r requirements/runtime.txt (line 1)) (1.17.0)\n",
            "Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->-r requirements/runtime.txt (line 3)) (1.3.2)\n",
            "Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.11/dist-packages (from matplotlib->-r requirements/runtime.txt (line 3)) (0.12.1)\n",
            "Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.11/dist-packages (from matplotlib->-r requirements/runtime.txt (line 3)) (4.59.0)\n",
            "Requirement already satisfied: kiwisolver>=1.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->-r requirements/runtime.txt (line 3)) (1.4.8)\n",
            "Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.11/dist-packages (from matplotlib->-r requirements/runtime.txt (line 3)) (24.2)\n",
            "Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->-r requirements/runtime.txt (line 3)) (3.2.3)\n",
            "Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.11/dist-packages (from matplotlib->-r requirements/runtime.txt (line 3)) (2.9.0.post0)\n",
            "Requirement already satisfied: setuptools>=18.0 in /usr/local/lib/python3.11/dist-packages (from xtcocotools>=1.12->-r requirements/runtime.txt (line 10)) (60.2.0)\n",
            "Requirement already satisfied: cython>=0.27.3 in /usr/local/lib/python3.11/dist-packages (from xtcocotools>=1.12->-r requirements/runtime.txt (line 10)) (3.0.12)\n",
            "Collecting mccabe<0.8.0,>=0.7.0 (from flake8->-r requirements/tests.txt (line 2))\n",
            "  Downloading mccabe-0.7.0-py2.py3-none-any.whl.metadata (5.0 kB)\n",
            "Collecting pycodestyle<2.15.0,>=2.14.0 (from flake8->-r requirements/tests.txt (line 2))\n",
            "  Downloading pycodestyle-2.14.0-py2.py3-none-any.whl.metadata (4.5 kB)\n",
            "Collecting pyflakes<3.5.0,>=3.4.0 (from flake8->-r requirements/tests.txt (line 2))\n",
            "  Downloading pyflakes-3.4.0-py2.py3-none-any.whl.metadata (3.5 kB)\n",
            "Requirement already satisfied: attrs in /usr/local/lib/python3.11/dist-packages (from interrogate->-r requirements/tests.txt (line 3)) (25.3.0)\n",
            "Requirement already satisfied: click>=7.1 in /usr/local/lib/python3.11/dist-packages (from interrogate->-r requirements/tests.txt (line 3)) (8.2.1)\n",
            "Requirement already satisfied: colorama in /usr/local/lib/python3.11/dist-packages (from interrogate->-r requirements/tests.txt (line 3)) (0.4.6)\n",
            "Collecting py (from interrogate->-r requirements/tests.txt (line 3))\n",
            "  Downloading py-1.11.0-py2.py3-none-any.whl.metadata (2.8 kB)\n",
            "Requirement already satisfied: tabulate in /usr/local/lib/python3.11/dist-packages (from interrogate->-r requirements/tests.txt (line 3)) (0.9.0)\n",
            "Requirement already satisfied: iniconfig>=1 in /usr/local/lib/python3.11/dist-packages (from pytest->-r requirements/tests.txt (line 6)) (2.1.0)\n",
            "Requirement already satisfied: pluggy<2,>=1.5 in /usr/local/lib/python3.11/dist-packages (from pytest->-r requirements/tests.txt (line 6)) (1.6.0)\n",
            "Requirement already satisfied: pygments>=2.7.2 in /usr/local/lib/python3.11/dist-packages (from pytest->-r requirements/tests.txt (line 6)) (2.19.2)\n",
            "Requirement already satisfied: platformdirs>=3.5.1 in /usr/local/lib/python3.11/dist-packages (from yapf->-r requirements/tests.txt (line 9)) (4.3.8)\n",
            "Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.11/dist-packages (from requests->-r requirements/optional.txt (line 1)) (3.4.2)\n",
            "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.11/dist-packages (from requests->-r requirements/optional.txt (line 1)) (3.10)\n",
            "Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests->-r requirements/optional.txt (line 1)) (1.26.20)\n",
            "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.11/dist-packages (from requests->-r requirements/optional.txt (line 1)) (2025.7.14)\n",
            "Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.11/dist-packages (from jinja2->torch>=1.8->-r requirements/build.txt (line 3)) (3.0.2)\n",
            "Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.11/dist-packages (from sympy->torch>=1.8->-r requirements/build.txt (line 3)) (1.3.0)\n",
            "Downloading isort-4.3.21-py2.py3-none-any.whl (42 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m42.3/42.3 kB\u001b[0m \u001b[31m2.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading json_tricks-3.17.3-py2.py3-none-any.whl (27 kB)\n",
            "Downloading munkres-1.1.4-py2.py3-none-any.whl (7.0 kB)\n",
            "Downloading coverage-7.10.1-cp311-cp311-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl (246 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m247.0/247.0 kB\u001b[0m \u001b[31m5.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading flake8-7.3.0-py2.py3-none-any.whl (57 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m57.9/57.9 kB\u001b[0m \u001b[31m3.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading interrogate-1.7.0-py3-none-any.whl (46 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m47.0/47.0 kB\u001b[0m \u001b[31m2.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading parameterized-0.9.0-py2.py3-none-any.whl (20 kB)\n",
            "Downloading pytest_runner-6.0.1-py3-none-any.whl (7.2 kB)\n",
            "Downloading xdoctest-1.2.0-py3-none-any.whl (151 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m151.2/151.2 kB\u001b[0m \u001b[31m7.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading mccabe-0.7.0-py2.py3-none-any.whl (7.3 kB)\n",
            "Downloading pycodestyle-2.14.0-py2.py3-none-any.whl (31 kB)\n",
            "Downloading pyflakes-3.4.0-py2.py3-none-any.whl (63 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m63.6/63.6 kB\u001b[0m \u001b[31m2.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading py-1.11.0-py2.py3-none-any.whl (98 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m98.7/98.7 kB\u001b[0m \u001b[31m5.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hBuilding wheels for collected packages: chumpy\n",
            "  Building wheel for chumpy (setup.py) ... \u001b[?25l\u001b[?25hdone\n",
            "  Created wheel for chumpy: filename=chumpy-0.70-py3-none-any.whl size=58279 sha256=db703f11743ccdc56a58802ea3a80bfa6054e7c8b884c6ba532fb53c72542f34\n",
            "  Stored in directory: /root/.cache/pip/wheels/91/96/31/3e16aa7084783b2e57a81bb9a7fa3598d32445a964b1692259\n",
            "Successfully built chumpy\n",
            "Installing collected packages: munkres, json_tricks, xdoctest, pytest-runner, pyflakes, pycodestyle, py, parameterized, mccabe, isort, coverage, interrogate, flake8, chumpy\n",
            "Successfully installed chumpy-0.70 coverage-7.10.1 flake8-7.3.0 interrogate-1.7.0 isort-4.3.21 json_tricks-3.17.3 mccabe-0.7.0 munkres-1.1.4 parameterized-0.9.0 py-1.11.0 pycodestyle-2.14.0 pyflakes-3.4.0 pytest-runner-6.0.1 xdoctest-1.2.0\n",
            "Using pip 24.1.2 from /usr/local/lib/python3.11/dist-packages/pip (python 3.11)\n",
            "\u001b[33mDEPRECATION: Loading egg at /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg is deprecated. pip 24.3 will enforce this behaviour change. A possible replacement is to use pip for package installation. Discussion can be found at https://github.com/pypa/pip/issues/12330\u001b[0m\u001b[33m\n",
            "\u001b[0mObtaining file:///content/mmdeploy/mmpose\n",
            "  Running command python setup.py egg_info\n",
            "  running egg_info\n",
            "  creating /tmp/pip-pip-egg-info-dpzvfvda/mmpose.egg-info\n",
            "  writing manifest file '/tmp/pip-pip-egg-info-dpzvfvda/mmpose.egg-info/SOURCES.txt'\n",
            "  warning: no files found matching 'mmpose/.mim/model-index.yml'\n",
            "  warning: no files found matching 'mmpose/.mim/dataset-index.yml'\n",
            "  warning: no files found matching '*.py' under directory 'mmpose/.mim/configs'\n",
            "  warning: no files found matching '*.yml' under directory 'mmpose/.mim/configs'\n",
            "  warning: no files found matching '*.py' under directory 'mmpose/.mim/tools'\n",
            "  warning: no files found matching '*.sh' under directory 'mmpose/.mim/tools'\n",
            "  warning: no files found matching '*.py' under directory 'mmpose/.mim/demo'\n",
            "  writing manifest file '/tmp/pip-pip-egg-info-dpzvfvda/mmpose.egg-info/SOURCES.txt'\n",
            "  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n",
            "Collecting xtcocotools@ git+https://github.com/jin-s13/xtcocoapi (from mmpose==1.3.2)\n",
            "  Cloning https://github.com/jin-s13/xtcocoapi to /tmp/pip-install-fg4hg2_j/xtcocotools_1af1afc6ecdb4be2b68a4a20fd583284\n",
            "  Running command git version\n",
            "  git version 2.34.1\n",
            "  Running command git clone --filter=blob:none https://github.com/jin-s13/xtcocoapi /tmp/pip-install-fg4hg2_j/xtcocotools_1af1afc6ecdb4be2b68a4a20fd583284\n",
            "  Cloning into '/tmp/pip-install-fg4hg2_j/xtcocotools_1af1afc6ecdb4be2b68a4a20fd583284'...\n",
            "  Running command git rev-parse HEAD\n",
            "  d74033ff1635e9002133b2380862bc2b728584d2\n",
            "  Resolved https://github.com/jin-s13/xtcocoapi to commit d74033ff1635e9002133b2380862bc2b728584d2\n",
            "  Running command git rev-parse HEAD\n",
            "  d74033ff1635e9002133b2380862bc2b728584d2\n",
            "  Running command python setup.py egg_info\n",
            "  running egg_info\n",
            "  creating /tmp/pip-pip-egg-info-zms73nn3/xtcocotools.egg-info\n",
            "  writing manifest file '/tmp/pip-pip-egg-info-zms73nn3/xtcocotools.egg-info/SOURCES.txt'\n",
            "  writing manifest file '/tmp/pip-pip-egg-info-zms73nn3/xtcocotools.egg-info/SOURCES.txt'\n",
            "  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n",
            "Requirement already satisfied: chumpy in /usr/local/lib/python3.11/dist-packages (from mmpose==1.3.2) (0.70)\n",
            "Requirement already satisfied: json_tricks in /usr/local/lib/python3.11/dist-packages (from mmpose==1.3.2) (3.17.3)\n",
            "Requirement already satisfied: matplotlib in /usr/local/lib/python3.11/dist-packages (from mmpose==1.3.2) (3.10.0)\n",
            "Requirement already satisfied: munkres in /usr/local/lib/python3.11/dist-packages (from mmpose==1.3.2) (1.1.4)\n",
            "Requirement already satisfied: numpy in /usr/local/lib/python3.11/dist-packages (from mmpose==1.3.2) (2.0.2)\n",
            "Requirement already satisfied: opencv-python in /usr/local/lib/python3.11/dist-packages (from mmpose==1.3.2) (4.12.0.88)\n",
            "Requirement already satisfied: pillow in /usr/local/lib/python3.11/dist-packages (from mmpose==1.3.2) (11.3.0)\n",
            "Requirement already satisfied: scipy in /usr/local/lib/python3.11/dist-packages (from mmpose==1.3.2) (1.16.0)\n",
            "Requirement already satisfied: torchvision in /usr/local/lib/python3.11/dist-packages (from mmpose==1.3.2) (0.15.2+cu118)\n",
            "Requirement already satisfied: six>=1.11.0 in /usr/local/lib/python3.11/dist-packages (from chumpy->mmpose==1.3.2) (1.17.0)\n",
            "Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmpose==1.3.2) (1.3.2)\n",
            "Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmpose==1.3.2) (0.12.1)\n",
            "Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmpose==1.3.2) (4.59.0)\n",
            "Requirement already satisfied: kiwisolver>=1.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmpose==1.3.2) (1.4.8)\n",
            "Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmpose==1.3.2) (24.2)\n",
            "Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmpose==1.3.2) (3.2.3)\n",
            "Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmpose==1.3.2) (2.9.0.post0)\n",
            "Requirement already satisfied: requests in /usr/local/lib/python3.11/dist-packages (from torchvision->mmpose==1.3.2) (2.28.2)\n",
            "Requirement already satisfied: torch==2.0.1 in /usr/local/lib/python3.11/dist-packages (from torchvision->mmpose==1.3.2) (2.0.1+cu118)\n",
            "Requirement already satisfied: filelock in /usr/local/lib/python3.11/dist-packages (from torch==2.0.1->torchvision->mmpose==1.3.2) (3.14.0)\n",
            "Requirement already satisfied: typing-extensions in /usr/local/lib/python3.11/dist-packages (from torch==2.0.1->torchvision->mmpose==1.3.2) (4.14.1)\n",
            "Requirement already satisfied: sympy in /usr/local/lib/python3.11/dist-packages (from torch==2.0.1->torchvision->mmpose==1.3.2) (1.13.1)\n",
            "Requirement already satisfied: networkx in /usr/local/lib/python3.11/dist-packages (from torch==2.0.1->torchvision->mmpose==1.3.2) (3.5)\n",
            "Requirement already satisfied: jinja2 in /usr/local/lib/python3.11/dist-packages (from torch==2.0.1->torchvision->mmpose==1.3.2) (3.1.6)\n",
            "Requirement already satisfied: triton==2.0.0 in /usr/local/lib/python3.11/dist-packages (from torch==2.0.1->torchvision->mmpose==1.3.2) (2.0.0)\n",
            "Requirement already satisfied: cmake in /usr/local/lib/python3.11/dist-packages (from triton==2.0.0->torch==2.0.1->torchvision->mmpose==1.3.2) (3.31.6)\n",
            "Requirement already satisfied: lit in /usr/local/lib/python3.11/dist-packages (from triton==2.0.0->torch==2.0.1->torchvision->mmpose==1.3.2) (15.0.7)\n",
            "Requirement already satisfied: setuptools>=18.0 in /usr/local/lib/python3.11/dist-packages (from xtcocotools@ git+https://github.com/jin-s13/xtcocoapi->mmpose==1.3.2) (60.2.0)\n",
            "Requirement already satisfied: cython>=0.27.3 in /usr/local/lib/python3.11/dist-packages (from xtcocotools@ git+https://github.com/jin-s13/xtcocoapi->mmpose==1.3.2) (3.0.12)\n",
            "Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.11/dist-packages (from requests->torchvision->mmpose==1.3.2) (3.4.2)\n",
            "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.11/dist-packages (from requests->torchvision->mmpose==1.3.2) (3.10)\n",
            "Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests->torchvision->mmpose==1.3.2) (1.26.20)\n",
            "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.11/dist-packages (from requests->torchvision->mmpose==1.3.2) (2025.7.14)\n",
            "Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.11/dist-packages (from jinja2->torch==2.0.1->torchvision->mmpose==1.3.2) (3.0.2)\n",
            "Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.11/dist-packages (from sympy->torch==2.0.1->torchvision->mmpose==1.3.2) (1.3.0)\n",
            "Installing collected packages: mmpose\n",
            "  Running setup.py develop for mmpose\n",
            "    Running command python setup.py develop\n",
            "    running develop\n",
            "    /usr/local/lib/python3.11/dist-packages/setuptools/command/easy_install.py:156: EasyInstallDeprecationWarning: easy_install command is deprecated. Use build and pip and other standards-based tools.\n",
            "      warnings.warn(\n",
            "    /usr/local/lib/python3.11/dist-packages/setuptools/command/install.py:34: SetuptoolsDeprecationWarning: setup.py install is deprecated. Use build and pip and other standards-based tools.\n",
            "      warnings.warn(\n",
            "    running egg_info\n",
            "    creating mmpose.egg-info\n",
            "    writing manifest file 'mmpose.egg-info/SOURCES.txt'\n",
            "    writing manifest file 'mmpose.egg-info/SOURCES.txt'\n",
            "    running build_ext\n",
            "Successfully installed mmpose-1.3.2\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "import numpy as np\n",
        "print(np.__version__)"
      ],
      "metadata": {
        "id": "5TTxLAHBY4Y4",
        "outputId": "a4c20331-f52f-4206-e256-000f5637f024",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "execution_count": 6,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "1.26.4\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "# Install dependencies\n",
        "!apt-get update && apt-get install -y \\\n",
        "    build-essential cmake git wget unzip \\\n",
        "    libprotobuf-dev protobuf-compiler \\\n",
        "    libopencv-dev python3-opencv\n",
        "\n",
        "# Clone and build NCNN\n",
        "!rm -rf ncnn && git clone --depth=1 https://github.com/Tencent/ncnn.git\n",
        "!mkdir -p ncnn/build && cd ncnn/build && \\\n",
        "    cmake .. -DCMAKE_BUILD_TYPE=Release && \\\n",
        "    make -j$(nproc) && \\\n",
        "    make install\n",
        "\n",
        "# Export PATH so mmdeploy can find mmdeploy_onnx2ncnn\n",
        "import os\n",
        "os.environ['PATH'] += \":/usr/local/bin\"\n",
        "\n",
        "# Confirm tool exists\n",
        "!which mmdeploy_onnx2ncnn || echo \"⚠️ mmdeploy_onnx2ncnn not found in PATH\"\n",
        "\n",
        "# Optional: check version\n",
        "!mmdeploy_onnx2ncnn -h || echo \"✅ Installed successfully or usage info printed.\"\n"
      ],
      "metadata": {
        "id": "YjRdHQk3bA3z"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "MODEL_CONFIG = \"/content/mmpose/configs/body_2d_keypoint/dekr/coco/dekr_hrnet-w32_8xb10-140e_coco-512x512.py\"\n",
        "MODEL_URL = \"https://download.openmmlab.com/mmpose/v1/body_2d_keypoint/dekr/coco/dekr_hrnet-w32_8xb10-140e_coco-512x512_ac7c17bf-20221228.pth\"\n",
        "MODEL_PATH = \"/content/dekr_hrnet-w32_8xb10-140e_coco-512x512_ac7c17bf-20221228.pth\"\n",
        "TEST_IMAGE = \"/content/data/coco/images/val2017/000000000139.jpg\"  # Sample COCO image\n",
        "WORK_DIR = \"/content/quantized_dekr_model\"\n",
        "\n",
        "\n",
        "%cd /content/mmdeploy\n",
        "!python3 tools/deploy.py \\\n",
        "  configs/mmpose/pose-detection_ncnn-int8_static-256x256.py \\\n",
        "  $MODEL_CONFIG \\\n",
        "  $MODEL_PATH \\\n",
        "  $TEST_IMAGE \\\n",
        "  --work-dir $WORK_DIR \\\n",
        "  --device cpu \\\n",
        "  --quant \\\n",
        "  --quant-image-dir $calibration_dir\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "IS-VmdnvWHh6",
        "outputId": "68e070dd-fb5e-4063-bf3a-174531c7876b"
      },
      "execution_count": 7,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "/content/mmdeploy\n",
            "07/29 13:34:37 - mmengine - \u001b[4m\u001b[97mINFO\u001b[0m - Start pipeline mmdeploy.apis.pytorch2onnx.torch2onnx in subprocess\n",
            "07/29 13:34:41 - mmengine - \u001b[5m\u001b[4m\u001b[33mWARNING\u001b[0m - Failed to search registry with scope \"mmpose\" in the \"Codebases\" registry tree. As a workaround, the current \"Codebases\" registry in \"mmdeploy\" is used to build instance. This may cause unexpected failure when running the built modules. Please check whether \"mmpose\" is a correct scope, or whether the registry is initialized.\n",
            "07/29 13:34:41 - mmengine - \u001b[5m\u001b[4m\u001b[33mWARNING\u001b[0m - Failed to search registry with scope \"mmpose\" in the \"mmpose_tasks\" registry tree. As a workaround, the current \"mmpose_tasks\" registry in \"mmdeploy\" is used to build instance. This may cause unexpected failure when running the built modules. Please check whether \"mmpose\" is a correct scope, or whether the registry is initialized.\n",
            "Loads checkpoint by local backend from path: /content/dekr_hrnet-w32_8xb10-140e_coco-512x512_ac7c17bf-20221228.pth\n",
            "07/29 13:34:43 - mmengine - \u001b[5m\u001b[4m\u001b[33mWARNING\u001b[0m - Input shape from deploy config is not same as input_size in model config:[256, 256] vs (512, 512)\n",
            "/content/mmdeploy/mmpose/mmpose/datasets/datasets/utils.py:102: UserWarning: The metainfo config file \"configs/_base_/datasets/coco.py\" does not exist. A matched config file \"/content/mmdeploy/mmpose/mmpose/.mim/configs/_base_/datasets/coco.py\" will be used instead.\n",
            "  warnings.warn(\n",
            "07/29 13:34:43 - mmengine - \u001b[5m\u001b[4m\u001b[33mWARNING\u001b[0m - DeprecationWarning: get_onnx_config will be deprecated in the future. \n",
            "07/29 13:34:43 - mmengine - \u001b[4m\u001b[97mINFO\u001b[0m - Export PyTorch model to ONNX: /content/quantized_dekr_model/end2end.onnx.\n",
            "07/29 13:34:43 - mmengine - \u001b[5m\u001b[4m\u001b[33mWARNING\u001b[0m - Can not find mmdet.models.dense_heads.RPNHead.get_bboxes, function rewrite will not be applied\n",
            "/content/mmdeploy/mmdeploy/pytorch/functions/getattribute.py:19: TracerWarning: Converting a tensor to a Python integer might cause the trace to be incorrect. We can't record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!\n",
            "  ret = torch.Size([int(s) for s in ret])\n",
            "/content/mmdeploy/mmdeploy/pytorch/functions/size.py:23: TracerWarning: Converting a tensor to a Python integer might cause the trace to be incorrect. We can't record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!\n",
            "  ret = [int(r) for r in ret]\n",
            "/content/mmdeploy/mmdeploy/pytorch/functions/size.py:19: TracerWarning: Converting a tensor to a Python integer might cause the trace to be incorrect. We can't record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!\n",
            "  ret = int(ret)\n",
            "[W shape_type_inference.cpp:1920] Warning: The shape inference of mmdeploy::MMCVDeformConv2d type is missing, so it may result in wrong shape inference for the exported graph. Please consider adding it in symbolic function. (function UpdateReliable)\n",
            "[W shape_type_inference.cpp:1920] Warning: The shape inference of mmdeploy::MMCVDeformConv2d type is missing, so it may result in wrong shape inference for the exported graph. Please consider adding it in symbolic function. (function UpdateReliable)\n",
            "============= Diagnostic Run torch.onnx.export version 2.0.1+cu118 =============\n",
            "verbose: False, log level: Level.ERROR\n",
            "======================= 0 NONE 0 NOTE 2 WARNING 0 ERROR ========================\n",
            "2 WARNING were not printed due to the log level.\n",
            "\n",
            "07/29 13:41:33 - mmengine - \u001b[4m\u001b[97mINFO\u001b[0m - Finish pipeline mmdeploy.apis.pytorch2onnx.torch2onnx\n",
            "07/29 13:41:35 - mmengine - \u001b[4m\u001b[97mINFO\u001b[0m - Start pipeline mmdeploy.apis.utils.utils.to_backend in main process\n",
            "07/29 13:41:35 - mmengine - \u001b[5m\u001b[4m\u001b[31mERROR\u001b[0m - /content/mmdeploy/mmdeploy/backend/ncnn/backend_manager.py - to_backend - 128 - ncnn support is not available, please make sure:\n",
            "1) `mmdeploy_onnx2ncnn` existed in `PATH`\n",
            "2) python import ncnn success\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "import os\n",
        "import glob\n",
        "import mmdeploy\n",
        "from ppq import *\n",
        "from ppq.api import quantize_onnx_model\n",
        "import torch\n",
        "import numpy as np\n",
        "\n",
        "# Define paths from configuration\n",
        "MODEL_CONFIG = \"/content/mmpose/configs/body_2d_keypoint/dekr/coco/dekr_hrnet-w32_8xb10-140e_coco-512x512.py\"\n",
        "MODEL_PATH = \"/content/dekr_hrnet-w32_8xb10-140e_coco-512x512_ac7c17bf-20221228.pth\"\n",
        "TEST_IMAGE = \"/content/data/coco/images/val2017/000000000139.jpg\"\n",
        "CALIBRATION_DIR = \"/content/calibration_images\"\n",
        "NUM_CALIB_IMAGES = 200\n",
        "WORK_DIR = \"/content/quantized_dekr_model\"\n",
        "\n",
        "# Ensure working directory exists\n",
        "os.makedirs(WORK_DIR, exist_ok=True)\n",
        "\n",
        "\n",
        "# Step 1: Convert MMPose model to ONNX using MMDeploy\n",
        "onnx_path = os.path.join(WORK_DIR, \"dekr_hrnet_w32.onnx\")\n",
        "if not os.path.exists(onnx_path):\n",
        "    print(\"Converting MMPose model to ONNX...\")\n",
        "    cmd = (\n",
        "        f\"python -m mmdeploy.tools.deploy \"\n",
        "        f\"configs/mmpose/pose-detection_onnx_static.py \"\n",
        "        f\"--config {MODEL_CONFIG} \"\n",
        "        f\"--model {MODEL_PATH} \"\n",
        "        f\"--output-dir {WORK_DIR} \"\n",
        "        f\"--device cpu \"\n",
        "        f\"--backend onnx \"\n",
        "        f\"--input {TEST_IMAGE}\"\n",
        "    )\n",
        "    result = os.system(cmd)\n",
        "    if result != 0:\n",
        "        raise RuntimeError(\"ONNX conversion failed. Check MMDeploy command output.\")\n",
        "    print(f\"✅ ONNX model saved to: {onnx_path}\")\n",
        "else:\n",
        "    print(f\"✅ ONNX model already exists: {onnx_path}\")\n",
        "\n",
        "# Step 2: Prepare calibration dataset for PPQ\n",
        "calibration_images = glob.glob(os.path.join(CALIBRATION_DIR, \"*.jpg\"))[:NUM_CALIB_IMAGES]\n",
        "if len(calibration_images) == 0:\n",
        "    raise FileNotFoundError(f\"No images found in {CALIBRATION_DIR}\")\n",
        "print(f\"Using {len(calibration_images)} images for calibration\")\n",
        "\n",
        "# Define a data loader for PPQ\n",
        "def load_calibration_data():\n",
        "    from PIL import Image\n",
        "    import torchvision.transforms as transforms\n",
        "    transform = transforms.Compose([\n",
        "        transforms.Resize((512, 512)),  # Match DEKR input size\n",
        "        transforms.ToTensor(),\n",
        "        transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])\n",
        "    ])\n",
        "    for img_path in calibration_images:\n",
        "        img = Image.open(img_path).convert(\"RGB\")\n",
        "        img_tensor = transform(img).numpy()\n",
        "        yield [img_tensor]  # PPQ expects a list of inputs\n",
        "\n",
        "# Step 3: Quantize the ONNX model for NCNN using PPQ\n",
        "quantized_onnx_path = os.path.join(WORK_DIR, \"dekr_hrnet_w32_quantized.onnx\")\n",
        "ncnn_param_path = os.path.join(WORK_DIR, \"dekr_hrnet_w32_ncnn.param\")\n",
        "ncnn_bin_path = os.path.join(WORK_DIR, \"dekr_hrnet_w32_ncnn.bin\")\n",
        "if not os.path.exists(quantized_onnx_path):\n",
        "    print(\"Quantizing ONNX model with PPQ for NCNN...\")\n",
        "    # Configure quantization settings for int8\n",
        "    quant_setting = QuantizationSettingFactory.default_setting()\n",
        "    quant_setting.quantize_activation = True\n",
        "    quant_setting.quantize_parameter = True\n",
        "    quant_setting.equalization = True  # Enable equalization for better int8 accuracy\n",
        "    quant_setting.per_channel = True  # Use per-channel quantization for weights\n",
        "\n",
        "    quantizer = quantize_onnx_model(\n",
        "        onnx_import_file=onnx_path,\n",
        "        calib_dataloader=load_calibration_data(),\n",
        "        calib_steps=NUM_CALIB_IMAGES,\n",
        "        input_shape=[1, 3, 512, 512],  # DEKR input shape\n",
        "        platform=TargetPlatform.NCNN_INT8,  # Target NCNN int8\n",
        "        quant_level=1,\n",
        "        setting=quant_setting\n",
        "    )\n",
        "    quantized_model = quantizer.quantize()\n",
        "    quantizer.save(quantized_onnx_path)\n",
        "\n",
        "    # Export to NCNN format\n",
        "    print(\"Exporting quantized model to NCNN format...\")\n",
        "    exporter = ExporterFactory.get_exporter(TargetPlatform.NCNN_INT8)\n",
        "    exporter.export(\n",
        "        quantized_model=quantized_model,\n",
        "        platform=TargetPlatform.NCNN_INT8,\n",
        "        export_file=ncnn_param_path,\n",
        "        bin_file=ncnn_bin_path\n",
        "    )\n",
        "    print(f\"✅ Quantized ONNX model saved to: {quantized_onnx_path}\")\n",
        "    print(f\"✅ NCNN param file saved to: {ncnn_param_path}\")\n",
        "    print(f\"✅ NCNN bin file saved to: {ncnn_bin_path}\")\n",
        "else:\n",
        "    print(f\"✅ Quantized model already exists: {quantized_onnx_path}\")\n",
        "\n",
        "# Step 4: Verify the quantized ONNX model\n",
        "print(\"Verifying quantized ONNX model...\")\n",
        "import onnxruntime as ort\n",
        "session = ort.InferenceSession(quantized_onnx_path)\n",
        "input_name = session.get_inputs()[0].name\n",
        "dummy_input = np.random.randn(1, 3, 512, 512).astype(np.float32)\n",
        "outputs = session.run(None, {input_name: dummy_input})\n",
        "print(\"✅ Quantized ONNX model inference successful\")"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 228
        },
        "id": "XGnwYhX89h5g",
        "outputId": "5b0e2c62-0f3d-42ca-b578-c2f4503b7422"
      },
      "execution_count": 24,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Converting MMPose model to ONNX...\n"
          ]
        },
        {
          "output_type": "error",
          "ename": "RuntimeError",
          "evalue": "ONNX conversion failed. Check MMDeploy command output.",
          "traceback": [
            "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
            "\u001b[0;31mRuntimeError\u001b[0m                              Traceback (most recent call last)",
            "\u001b[0;32m/tmp/ipython-input-24-3720315733.py\u001b[0m in \u001b[0;36m<cell line: 0>\u001b[0;34m()\u001b[0m\n\u001b[1;32m     35\u001b[0m     \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msystem\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcmd\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     36\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mresult\u001b[0m \u001b[0;34m!=\u001b[0m \u001b[0;36m0\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 37\u001b[0;31m         \u001b[0;32mraise\u001b[0m \u001b[0mRuntimeError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"ONNX conversion failed. Check MMDeploy command output.\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     38\u001b[0m     \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34mf\"✅ ONNX model saved to: {onnx_path}\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     39\u001b[0m \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;31mRuntimeError\u001b[0m: ONNX conversion failed. Check MMDeploy command output."
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "!pip install numpy==1.23.5 # Or 1.24.4, or similar pre-2.0 version"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 706
        },
        "id": "WrFo291HDjnF",
        "outputId": "d6162db5-f57a-49db-bca3-87509261a72d"
      },
      "execution_count": 45,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "\u001b[33mDEPRECATION: Loading egg at /usr/local/lib/python3.11/dist-packages/ppq-0.6.6-py3.11.egg is deprecated. pip 24.3 will enforce this behaviour change. A possible replacement is to use pip for package installation. Discussion can be found at https://github.com/pypa/pip/issues/12330\u001b[0m\u001b[33m\n",
            "\u001b[0mCollecting numpy==1.23.5\n",
            "  Downloading numpy-1.23.5-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (2.3 kB)\n",
            "Downloading numpy-1.23.5-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (17.1 MB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m17.1/17.1 MB\u001b[0m \u001b[31m24.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hInstalling collected packages: numpy\n",
            "\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n",
            "onnxruntime 1.17.1 requires numpy>=1.24.2, but you have numpy 1.23.5 which is incompatible.\n",
            "jax 0.5.2 requires numpy>=1.25, but you have numpy 1.23.5 which is incompatible.\n",
            "xarray-einstats 0.9.1 requires numpy>=1.25, but you have numpy 1.23.5 which is incompatible.\n",
            "xarray 2025.7.1 requires numpy>=1.26, but you have numpy 1.23.5 which is incompatible.\n",
            "ydf 0.13.0 requires protobuf<7.0.0,>=5.29.1, but you have protobuf 3.20.2 which is incompatible.\n",
            "opencv-python 4.12.0.88 requires numpy<2.3.0,>=2; python_version >= \"3.9\", but you have numpy 1.23.5 which is incompatible.\n",
            "tensorflow 2.18.0 requires numpy<2.1.0,>=1.26.0, but you have numpy 1.23.5 which is incompatible.\n",
            "tensorflow 2.18.0 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.3, but you have protobuf 3.20.2 which is incompatible.\n",
            "chex 0.1.90 requires numpy>=1.24.1, but you have numpy 1.23.5 which is incompatible.\n",
            "treescope 0.1.9 requires numpy>=1.25.2, but you have numpy 1.23.5 which is incompatible.\n",
            "arviz 0.22.0 requires numpy>=1.26.0, but you have numpy 1.23.5 which is incompatible.\n",
            "opencv-contrib-python 4.12.0.88 requires numpy<2.3.0,>=2; python_version >= \"3.9\", but you have numpy 1.23.5 which is incompatible.\n",
            "pymc 5.25.1 requires numpy>=1.25.0, but you have numpy 1.23.5 which is incompatible.\n",
            "imbalanced-learn 0.13.0 requires numpy<3,>=1.24.3, but you have numpy 1.23.5 which is incompatible.\n",
            "db-dtypes 1.4.3 requires numpy>=1.24.0, but you have numpy 1.23.5 which is incompatible.\n",
            "jaxlib 0.5.1 requires numpy>=1.25, but you have numpy 1.23.5 which is incompatible.\n",
            "geopandas 1.1.1 requires numpy>=1.24, but you have numpy 1.23.5 which is incompatible.\n",
            "thinc 8.3.6 requires numpy<3.0.0,>=2.0.0, but you have numpy 1.23.5 which is incompatible.\n",
            "blosc2 3.6.1 requires numpy>=1.26, but you have numpy 1.23.5 which is incompatible.\n",
            "scipy 1.16.0 requires numpy<2.6,>=1.25.2, but you have numpy 1.23.5 which is incompatible.\n",
            "albucore 0.0.24 requires numpy>=1.24.4, but you have numpy 1.23.5 which is incompatible.\n",
            "bigframes 2.12.0 requires numpy>=1.24.0, but you have numpy 1.23.5 which is incompatible.\n",
            "opencv-python-headless 4.12.0.88 requires numpy<2.3.0,>=2; python_version >= \"3.9\", but you have numpy 1.23.5 which is incompatible.\n",
            "albumentations 2.0.8 requires numpy>=1.24.4, but you have numpy 1.23.5 which is incompatible.\n",
            "scikit-image 0.25.2 requires numpy>=1.24, but you have numpy 1.23.5 which is incompatible.\u001b[0m\u001b[31m\n",
            "\u001b[0mSuccessfully installed numpy-1.23.5\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "application/vnd.colab-display-data+json": {
              "pip_warning": {
                "packages": [
                  "numpy"
                ]
              },
              "id": "87ec9ed1738943b5886878c06bcc05a4"
            }
          },
          "metadata": {}
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "!pip3 install openmim\n",
        "!mim install mmengine\n",
        "!mim install \"mmcv>=2.0.0,<2.1.0\""
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 1000
        },
        "id": "pQjl0O2FEuxc",
        "outputId": "7393837d-2c0b-49c2-fc32-92c1e11f3d3e"
      },
      "execution_count": 1,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Collecting openmim\n",
            "  Downloading openmim-0.3.9-py2.py3-none-any.whl.metadata (16 kB)\n",
            "Requirement already satisfied: Click in /usr/local/lib/python3.11/dist-packages (from openmim) (8.2.1)\n",
            "Collecting colorama (from openmim)\n",
            "  Downloading colorama-0.4.6-py2.py3-none-any.whl.metadata (17 kB)\n",
            "Collecting model-index (from openmim)\n",
            "  Downloading model_index-0.1.11-py3-none-any.whl.metadata (3.9 kB)\n",
            "Collecting opendatalab (from openmim)\n",
            "  Downloading opendatalab-0.0.10-py3-none-any.whl.metadata (6.4 kB)\n",
            "Requirement already satisfied: pandas in /usr/local/lib/python3.11/dist-packages (from openmim) (2.2.2)\n",
            "Requirement already satisfied: pip>=19.3 in /usr/local/lib/python3.11/dist-packages (from openmim) (24.1.2)\n",
            "Requirement already satisfied: requests in /usr/local/lib/python3.11/dist-packages (from openmim) (2.32.3)\n",
            "Requirement already satisfied: rich in /usr/local/lib/python3.11/dist-packages (from openmim) (13.9.4)\n",
            "Requirement already satisfied: tabulate in /usr/local/lib/python3.11/dist-packages (from openmim) (0.9.0)\n",
            "Requirement already satisfied: pyyaml in /usr/local/lib/python3.11/dist-packages (from model-index->openmim) (6.0.2)\n",
            "Requirement already satisfied: markdown in /usr/local/lib/python3.11/dist-packages (from model-index->openmim) (3.8.2)\n",
            "Collecting ordered-set (from model-index->openmim)\n",
            "  Downloading ordered_set-4.1.0-py3-none-any.whl.metadata (5.3 kB)\n",
            "Collecting pycryptodome (from opendatalab->openmim)\n",
            "  Downloading pycryptodome-3.23.0-cp37-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (3.4 kB)\n",
            "Requirement already satisfied: tqdm in /usr/local/lib/python3.11/dist-packages (from opendatalab->openmim) (4.67.1)\n",
            "Collecting openxlab (from opendatalab->openmim)\n",
            "  Downloading openxlab-0.1.2-py3-none-any.whl.metadata (3.8 kB)\n",
            "Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.11/dist-packages (from requests->openmim) (3.4.2)\n",
            "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.11/dist-packages (from requests->openmim) (3.10)\n",
            "Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests->openmim) (2.5.0)\n",
            "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.11/dist-packages (from requests->openmim) (2025.7.14)\n",
            "Requirement already satisfied: numpy>=1.23.2 in /usr/local/lib/python3.11/dist-packages (from pandas->openmim) (2.0.2)\n",
            "Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.11/dist-packages (from pandas->openmim) (2.9.0.post0)\n",
            "Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.11/dist-packages (from pandas->openmim) (2025.2)\n",
            "Requirement already satisfied: tzdata>=2022.7 in /usr/local/lib/python3.11/dist-packages (from pandas->openmim) (2025.2)\n",
            "Requirement already satisfied: markdown-it-py>=2.2.0 in /usr/local/lib/python3.11/dist-packages (from rich->openmim) (3.0.0)\n",
            "Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /usr/local/lib/python3.11/dist-packages (from rich->openmim) (2.19.2)\n",
            "Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.11/dist-packages (from markdown-it-py>=2.2.0->rich->openmim) (0.1.2)\n",
            "Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.11/dist-packages (from python-dateutil>=2.8.2->pandas->openmim) (1.17.0)\n",
            "Collecting filelock~=3.14.0 (from openxlab->opendatalab->openmim)\n",
            "  Downloading filelock-3.14.0-py3-none-any.whl.metadata (2.8 kB)\n",
            "Collecting oss2~=2.17.0 (from openxlab->opendatalab->openmim)\n",
            "  Downloading oss2-2.17.0.tar.gz (259 kB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m259.5/259.5 kB\u001b[0m \u001b[31m5.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n",
            "Collecting packaging~=24.0 (from openxlab->opendatalab->openmim)\n",
            "  Downloading packaging-24.2-py3-none-any.whl.metadata (3.2 kB)\n",
            "Collecting pytz>=2020.1 (from pandas->openmim)\n",
            "  Downloading pytz-2023.4-py2.py3-none-any.whl.metadata (22 kB)\n",
            "Collecting requests (from openmim)\n",
            "  Downloading requests-2.28.2-py3-none-any.whl.metadata (4.6 kB)\n",
            "Collecting rich (from openmim)\n",
            "  Downloading rich-13.4.2-py3-none-any.whl.metadata (18 kB)\n",
            "Collecting setuptools~=60.2.0 (from openxlab->opendatalab->openmim)\n",
            "  Downloading setuptools-60.2.0-py3-none-any.whl.metadata (5.1 kB)\n",
            "Collecting tqdm (from opendatalab->openmim)\n",
            "  Downloading tqdm-4.65.2-py3-none-any.whl.metadata (56 kB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m57.0/57.0 kB\u001b[0m \u001b[31m2.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hCollecting urllib3<1.27,>=1.21.1 (from requests->openmim)\n",
            "  Downloading urllib3-1.26.20-py2.py3-none-any.whl.metadata (50 kB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m50.1/50.1 kB\u001b[0m \u001b[31m2.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hCollecting crcmod>=1.7 (from oss2~=2.17.0->openxlab->opendatalab->openmim)\n",
            "  Downloading crcmod-1.7.tar.gz (89 kB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m89.7/89.7 kB\u001b[0m \u001b[31m5.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n",
            "Collecting aliyun-python-sdk-kms>=2.4.1 (from oss2~=2.17.0->openxlab->opendatalab->openmim)\n",
            "  Downloading aliyun_python_sdk_kms-2.16.5-py2.py3-none-any.whl.metadata (1.5 kB)\n",
            "Collecting aliyun-python-sdk-core>=2.13.12 (from oss2~=2.17.0->openxlab->opendatalab->openmim)\n",
            "  Downloading aliyun-python-sdk-core-2.16.0.tar.gz (449 kB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m449.6/449.6 kB\u001b[0m \u001b[31m17.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n",
            "Collecting jmespath<1.0.0,>=0.9.3 (from aliyun-python-sdk-core>=2.13.12->oss2~=2.17.0->openxlab->opendatalab->openmim)\n",
            "  Downloading jmespath-0.10.0-py2.py3-none-any.whl.metadata (8.0 kB)\n",
            "Requirement already satisfied: cryptography>=3.0.0 in /usr/local/lib/python3.11/dist-packages (from aliyun-python-sdk-core>=2.13.12->oss2~=2.17.0->openxlab->opendatalab->openmim) (43.0.3)\n",
            "Requirement already satisfied: cffi>=1.12 in /usr/local/lib/python3.11/dist-packages (from cryptography>=3.0.0->aliyun-python-sdk-core>=2.13.12->oss2~=2.17.0->openxlab->opendatalab->openmim) (1.17.1)\n",
            "Requirement already satisfied: pycparser in /usr/local/lib/python3.11/dist-packages (from cffi>=1.12->cryptography>=3.0.0->aliyun-python-sdk-core>=2.13.12->oss2~=2.17.0->openxlab->opendatalab->openmim) (2.22)\n",
            "Downloading openmim-0.3.9-py2.py3-none-any.whl (52 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m52.7/52.7 kB\u001b[0m \u001b[31m3.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading colorama-0.4.6-py2.py3-none-any.whl (25 kB)\n",
            "Downloading model_index-0.1.11-py3-none-any.whl (34 kB)\n",
            "Downloading opendatalab-0.0.10-py3-none-any.whl (29 kB)\n",
            "Downloading openxlab-0.1.2-py3-none-any.whl (311 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m311.5/311.5 kB\u001b[0m \u001b[31m17.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading requests-2.28.2-py3-none-any.whl (62 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m62.8/62.8 kB\u001b[0m \u001b[31m3.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading rich-13.4.2-py3-none-any.whl (239 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m239.4/239.4 kB\u001b[0m \u001b[31m14.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading pytz-2023.4-py2.py3-none-any.whl (506 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m506.5/506.5 kB\u001b[0m \u001b[31m27.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading tqdm-4.65.2-py3-none-any.whl (77 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m77.1/77.1 kB\u001b[0m \u001b[31m5.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading urllib3-1.26.20-py2.py3-none-any.whl (144 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m144.2/144.2 kB\u001b[0m \u001b[31m9.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading ordered_set-4.1.0-py3-none-any.whl (7.6 kB)\n",
            "Downloading pycryptodome-3.23.0-cp37-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.3 MB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m2.3/2.3 MB\u001b[0m \u001b[31m58.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading filelock-3.14.0-py3-none-any.whl (12 kB)\n",
            "Downloading packaging-24.2-py3-none-any.whl (65 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m65.5/65.5 kB\u001b[0m \u001b[31m4.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading setuptools-60.2.0-py3-none-any.whl (953 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m953.1/953.1 kB\u001b[0m \u001b[31m41.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading aliyun_python_sdk_kms-2.16.5-py2.py3-none-any.whl (99 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m99.5/99.5 kB\u001b[0m \u001b[31m6.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading jmespath-0.10.0-py2.py3-none-any.whl (24 kB)\n",
            "Building wheels for collected packages: oss2, aliyun-python-sdk-core, crcmod\n",
            "  Building wheel for oss2 (setup.py) ... \u001b[?25l\u001b[?25hdone\n",
            "  Created wheel for oss2: filename=oss2-2.17.0-py3-none-any.whl size=112371 sha256=e0fe0546463c2ebbd1981b3948952ae5ff18fba87a8d2b4c045856fe5bb9c323\n",
            "  Stored in directory: /root/.cache/pip/wheels/42/79/aa/3671e313c27de35211d345d7a9d8ccb7dde515cf05edba75df\n",
            "  Building wheel for aliyun-python-sdk-core (setup.py) ... \u001b[?25l\u001b[?25hdone\n",
            "  Created wheel for aliyun-python-sdk-core: filename=aliyun_python_sdk_core-2.16.0-py3-none-any.whl size=535315 sha256=31d6cd3a5b2243d18707e90522ff36abb598b3668b6f52cd7f9fd21ecb4e2f27\n",
            "  Stored in directory: /root/.cache/pip/wheels/2b/9a/95/60f111d2a488c5f7f7ed2a96ce407ea57ec7393ddfdec8c956\n",
            "  Building wheel for crcmod (setup.py) ... \u001b[?25l\u001b[?25hdone\n",
            "  Created wheel for crcmod: filename=crcmod-1.7-cp311-cp311-linux_x86_64.whl size=31660 sha256=5f21e3833bb7342b587838a786011190823984ca4a9d919faba38cab84a37813\n",
            "  Stored in directory: /root/.cache/pip/wheels/23/94/7a/8cb7d14597e6395ce969933f01aed9ea8fa5f5b4d4c8a61e99\n",
            "Successfully built oss2 aliyun-python-sdk-core crcmod\n",
            "Installing collected packages: pytz, crcmod, urllib3, tqdm, setuptools, pycryptodome, packaging, ordered-set, jmespath, filelock, colorama, rich, requests, model-index, aliyun-python-sdk-core, aliyun-python-sdk-kms, oss2, openxlab, opendatalab, openmim\n",
            "  Attempting uninstall: pytz\n",
            "    Found existing installation: pytz 2025.2\n",
            "    Uninstalling pytz-2025.2:\n",
            "      Successfully uninstalled pytz-2025.2\n",
            "  Attempting uninstall: urllib3\n",
            "    Found existing installation: urllib3 2.5.0\n",
            "    Uninstalling urllib3-2.5.0:\n",
            "      Successfully uninstalled urllib3-2.5.0\n",
            "  Attempting uninstall: tqdm\n",
            "    Found existing installation: tqdm 4.67.1\n",
            "    Uninstalling tqdm-4.67.1:\n",
            "      Successfully uninstalled tqdm-4.67.1\n",
            "  Attempting uninstall: setuptools\n",
            "    Found existing installation: setuptools 75.2.0\n",
            "    Uninstalling setuptools-75.2.0:\n",
            "      Successfully uninstalled setuptools-75.2.0\n",
            "  Attempting uninstall: packaging\n",
            "    Found existing installation: packaging 25.0\n",
            "    Uninstalling packaging-25.0:\n",
            "      Successfully uninstalled packaging-25.0\n",
            "  Attempting uninstall: filelock\n",
            "    Found existing installation: filelock 3.18.0\n",
            "    Uninstalling filelock-3.18.0:\n",
            "      Successfully uninstalled filelock-3.18.0\n",
            "  Attempting uninstall: rich\n",
            "    Found existing installation: rich 13.9.4\n",
            "    Uninstalling rich-13.9.4:\n",
            "      Successfully uninstalled rich-13.9.4\n",
            "  Attempting uninstall: requests\n",
            "    Found existing installation: requests 2.32.3\n",
            "    Uninstalling requests-2.32.3:\n",
            "      Successfully uninstalled requests-2.32.3\n",
            "\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n",
            "ipython 7.34.0 requires jedi>=0.16, which is not installed.\n",
            "google-colab 1.0.0 requires requests==2.32.3, but you have requests 2.28.2 which is incompatible.\n",
            "yfinance 0.2.65 requires requests>=2.31, but you have requests 2.28.2 which is incompatible.\n",
            "pymc 5.25.1 requires rich>=13.7.1, but you have rich 13.4.2 which is incompatible.\n",
            "torch 2.6.0+cu124 requires nvidia-cublas-cu12==12.4.5.8; platform_system == \"Linux\" and platform_machine == \"x86_64\", but you have nvidia-cublas-cu12 12.5.3.2 which is incompatible.\n",
            "torch 2.6.0+cu124 requires nvidia-cuda-cupti-cu12==12.4.127; platform_system == \"Linux\" and platform_machine == \"x86_64\", but you have nvidia-cuda-cupti-cu12 12.5.82 which is incompatible.\n",
            "torch 2.6.0+cu124 requires nvidia-cuda-nvrtc-cu12==12.4.127; platform_system == \"Linux\" and platform_machine == \"x86_64\", but you have nvidia-cuda-nvrtc-cu12 12.5.82 which is incompatible.\n",
            "torch 2.6.0+cu124 requires nvidia-cuda-runtime-cu12==12.4.127; platform_system == \"Linux\" and platform_machine == \"x86_64\", but you have nvidia-cuda-runtime-cu12 12.5.82 which is incompatible.\n",
            "torch 2.6.0+cu124 requires nvidia-cudnn-cu12==9.1.0.70; platform_system == \"Linux\" and platform_machine == \"x86_64\", but you have nvidia-cudnn-cu12 9.3.0.75 which is incompatible.\n",
            "torch 2.6.0+cu124 requires nvidia-cufft-cu12==11.2.1.3; platform_system == \"Linux\" and platform_machine == \"x86_64\", but you have nvidia-cufft-cu12 11.2.3.61 which is incompatible.\n",
            "torch 2.6.0+cu124 requires nvidia-curand-cu12==10.3.5.147; platform_system == \"Linux\" and platform_machine == \"x86_64\", but you have nvidia-curand-cu12 10.3.6.82 which is incompatible.\n",
            "torch 2.6.0+cu124 requires nvidia-cusolver-cu12==11.6.1.9; platform_system == \"Linux\" and platform_machine == \"x86_64\", but you have nvidia-cusolver-cu12 11.6.3.83 which is incompatible.\n",
            "torch 2.6.0+cu124 requires nvidia-cusparse-cu12==12.3.1.170; platform_system == \"Linux\" and platform_machine == \"x86_64\", but you have nvidia-cusparse-cu12 12.5.1.3 which is incompatible.\n",
            "torch 2.6.0+cu124 requires nvidia-nvjitlink-cu12==12.4.127; platform_system == \"Linux\" and platform_machine == \"x86_64\", but you have nvidia-nvjitlink-cu12 12.5.82 which is incompatible.\n",
            "datasets 4.0.0 requires requests>=2.32.2, but you have requests 2.28.2 which is incompatible.\n",
            "datasets 4.0.0 requires tqdm>=4.66.3, but you have tqdm 4.65.2 which is incompatible.\n",
            "pytensor 2.31.7 requires filelock>=3.15, but you have filelock 3.14.0 which is incompatible.\n",
            "dataproc-spark-connect 0.8.3 requires tqdm>=4.67, but you have tqdm 4.65.2 which is incompatible.\n",
            "sphinx 8.2.3 requires requests>=2.30.0, but you have requests 2.28.2 which is incompatible.\u001b[0m\u001b[31m\n",
            "\u001b[0mSuccessfully installed aliyun-python-sdk-core-2.16.0 aliyun-python-sdk-kms-2.16.5 colorama-0.4.6 crcmod-1.7 filelock-3.14.0 jmespath-0.10.0 model-index-0.1.11 opendatalab-0.0.10 openmim-0.3.9 openxlab-0.1.2 ordered-set-4.1.0 oss2-2.17.0 packaging-24.2 pycryptodome-3.23.0 pytz-2023.4 requests-2.28.2 rich-13.4.2 setuptools-60.2.0 tqdm-4.65.2 urllib3-1.26.20\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "application/vnd.colab-display-data+json": {
              "pip_warning": {
                "packages": [
                  "_distutils_hack",
                  "packaging"
                ]
              },
              "id": "62fb0c572fc24bcf9ca11b2bd28b56dd"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Looking in links: https://download.openmmlab.com/mmcv/dist/cu124/torch2.6.0/index.html\n",
            "Collecting mmengine\n",
            "  Downloading mmengine-0.10.7-py3-none-any.whl.metadata (20 kB)\n",
            "Collecting addict (from mmengine)\n",
            "  Downloading addict-2.4.0-py3-none-any.whl.metadata (1.0 kB)\n",
            "Requirement already satisfied: matplotlib in /usr/local/lib/python3.11/dist-packages (from mmengine) (3.10.0)\n",
            "Requirement already satisfied: numpy in /usr/local/lib/python3.11/dist-packages (from mmengine) (2.0.2)\n",
            "Requirement already satisfied: pyyaml in /usr/local/lib/python3.11/dist-packages (from mmengine) (6.0.2)\n",
            "Requirement already satisfied: rich in /usr/local/lib/python3.11/dist-packages (from mmengine) (13.4.2)\n",
            "Requirement already satisfied: termcolor in /usr/local/lib/python3.11/dist-packages (from mmengine) (3.1.0)\n",
            "Collecting yapf (from mmengine)\n",
            "  Downloading yapf-0.43.0-py3-none-any.whl.metadata (46 kB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m46.8/46.8 kB\u001b[0m \u001b[31m1.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hRequirement already satisfied: opencv-python>=3 in /usr/local/lib/python3.11/dist-packages (from mmengine) (4.12.0.88)\n",
            "Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine) (1.3.2)\n",
            "Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine) (0.12.1)\n",
            "Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine) (4.59.0)\n",
            "Requirement already satisfied: kiwisolver>=1.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine) (1.4.8)\n",
            "Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine) (24.2)\n",
            "Requirement already satisfied: pillow>=8 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine) (11.3.0)\n",
            "Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine) (3.2.3)\n",
            "Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine) (2.9.0.post0)\n",
            "Requirement already satisfied: markdown-it-py>=2.2.0 in /usr/local/lib/python3.11/dist-packages (from rich->mmengine) (3.0.0)\n",
            "Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /usr/local/lib/python3.11/dist-packages (from rich->mmengine) (2.19.2)\n",
            "Requirement already satisfied: platformdirs>=3.5.1 in /usr/local/lib/python3.11/dist-packages (from yapf->mmengine) (4.3.8)\n",
            "Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.11/dist-packages (from markdown-it-py>=2.2.0->rich->mmengine) (0.1.2)\n",
            "Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.11/dist-packages (from python-dateutil>=2.7->matplotlib->mmengine) (1.17.0)\n",
            "Downloading mmengine-0.10.7-py3-none-any.whl (452 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m452.7/452.7 kB\u001b[0m \u001b[31m9.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading addict-2.4.0-py3-none-any.whl (3.8 kB)\n",
            "Downloading yapf-0.43.0-py3-none-any.whl (256 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m256.2/256.2 kB\u001b[0m \u001b[31m13.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hInstalling collected packages: addict, yapf, mmengine\n",
            "Successfully installed addict-2.4.0 mmengine-0.10.7 yapf-0.43.0\n",
            "Looking in links: https://download.openmmlab.com/mmcv/dist/cu124/torch2.6.0/index.html\n",
            "Collecting mmcv<2.1.0,>=2.0.0\n",
            "  Downloading mmcv-2.0.1.tar.gz (469 kB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m469.5/469.5 kB\u001b[0m \u001b[31m7.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n",
            "Requirement already satisfied: addict in /usr/local/lib/python3.11/dist-packages (from mmcv<2.1.0,>=2.0.0) (2.4.0)\n",
            "Requirement already satisfied: mmengine>=0.3.0 in /usr/local/lib/python3.11/dist-packages (from mmcv<2.1.0,>=2.0.0) (0.10.7)\n",
            "Requirement already satisfied: numpy in /usr/local/lib/python3.11/dist-packages (from mmcv<2.1.0,>=2.0.0) (2.0.2)\n",
            "Requirement already satisfied: packaging in /usr/local/lib/python3.11/dist-packages (from mmcv<2.1.0,>=2.0.0) (24.2)\n",
            "Requirement already satisfied: Pillow in /usr/local/lib/python3.11/dist-packages (from mmcv<2.1.0,>=2.0.0) (11.3.0)\n",
            "Requirement already satisfied: pyyaml in /usr/local/lib/python3.11/dist-packages (from mmcv<2.1.0,>=2.0.0) (6.0.2)\n",
            "Requirement already satisfied: yapf in /usr/local/lib/python3.11/dist-packages (from mmcv<2.1.0,>=2.0.0) (0.43.0)\n",
            "Requirement already satisfied: matplotlib in /usr/local/lib/python3.11/dist-packages (from mmengine>=0.3.0->mmcv<2.1.0,>=2.0.0) (3.10.0)\n",
            "Requirement already satisfied: rich in /usr/local/lib/python3.11/dist-packages (from mmengine>=0.3.0->mmcv<2.1.0,>=2.0.0) (13.4.2)\n",
            "Requirement already satisfied: termcolor in /usr/local/lib/python3.11/dist-packages (from mmengine>=0.3.0->mmcv<2.1.0,>=2.0.0) (3.1.0)\n",
            "Requirement already satisfied: opencv-python>=3 in /usr/local/lib/python3.11/dist-packages (from mmengine>=0.3.0->mmcv<2.1.0,>=2.0.0) (4.12.0.88)\n",
            "Requirement already satisfied: platformdirs>=3.5.1 in /usr/local/lib/python3.11/dist-packages (from yapf->mmcv<2.1.0,>=2.0.0) (4.3.8)\n",
            "Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine>=0.3.0->mmcv<2.1.0,>=2.0.0) (1.3.2)\n",
            "Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine>=0.3.0->mmcv<2.1.0,>=2.0.0) (0.12.1)\n",
            "Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine>=0.3.0->mmcv<2.1.0,>=2.0.0) (4.59.0)\n",
            "Requirement already satisfied: kiwisolver>=1.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine>=0.3.0->mmcv<2.1.0,>=2.0.0) (1.4.8)\n",
            "Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine>=0.3.0->mmcv<2.1.0,>=2.0.0) (3.2.3)\n",
            "Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.11/dist-packages (from matplotlib->mmengine>=0.3.0->mmcv<2.1.0,>=2.0.0) (2.9.0.post0)\n",
            "Requirement already satisfied: markdown-it-py>=2.2.0 in /usr/local/lib/python3.11/dist-packages (from rich->mmengine>=0.3.0->mmcv<2.1.0,>=2.0.0) (3.0.0)\n",
            "Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /usr/local/lib/python3.11/dist-packages (from rich->mmengine>=0.3.0->mmcv<2.1.0,>=2.0.0) (2.19.2)\n",
            "Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.11/dist-packages (from markdown-it-py>=2.2.0->rich->mmengine>=0.3.0->mmcv<2.1.0,>=2.0.0) (0.1.2)\n",
            "Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.11/dist-packages (from python-dateutil>=2.7->matplotlib->mmengine>=0.3.0->mmcv<2.1.0,>=2.0.0) (1.17.0)\n",
            "Building wheels for collected packages: mmcv\n",
            "  \u001b[1;31merror\u001b[0m: \u001b[1msubprocess-exited-with-error\u001b[0m\n",
            "  \n",
            "  \u001b[31m×\u001b[0m \u001b[32mpython setup.py bdist_wheel\u001b[0m did not run successfully.\n",
            "  \u001b[31m│\u001b[0m exit code: \u001b[1;36m1\u001b[0m\n",
            "  \u001b[31m╰─>\u001b[0m See above for output.\n",
            "  \n",
            "  \u001b[1;35mnote\u001b[0m: This error originates from a subprocess, and is likely not a problem with pip.\n",
            "  Building wheel for mmcv (setup.py) ... \u001b[?25lerror\n",
            "\u001b[31m  ERROR: Failed building wheel for mmcv\u001b[0m\u001b[31m\n",
            "\u001b[0m\u001b[?25h  Running setup.py clean for mmcv\n",
            "Failed to build mmcv\n",
            "\u001b[31mERROR: ERROR: Failed to build installable wheels for some pyproject.toml based projects (mmcv)\u001b[0m\u001b[31m\n",
            "\u001b[0m"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "MODEL_CONFIG = \"/content/mmpose/configs/body_2d_keypoint/dekr/coco/dekr_hrnet-w32_8xb10-140e_coco-512x512.py\"\n",
        "MODEL_PATH = \"/content/dekr_hrnet-w32_8xb10-140e_coco-512x512_ac7c17bf-20221228.pth\"\n",
        "TEST_IMAGE = \"/content/data/coco/images/val2017/000000000139.jpg\"\n",
        "CALIBRATION_DIR = \"/content/calibration_images\"\n",
        "NUM_CALIB_IMAGES = 200\n",
        "WORK_DIR = \"/content/quantized_dekr_model\"\n",
        "\n",
        "\n",
        "%cd /content/mmdeploy\n",
        "\n",
        "!pwd\n",
        "\n",
        "!python3 tools/deploy.py \\\n",
        "    configs/mmpose/pose-detection_onnxruntime_static.py \\\n",
        "    {MODEL_CONFIG} \\\n",
        "    {MODEL_PATH} \\\n",
        "    {TEST_IMAGE} \\\n",
        "    --work-dir {WORK_DIR} \\\n",
        "    --device cpu"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "GH4oBrVhBM7e",
        "outputId": "e4d35011-7cfe-4f5c-ea66-d2ff9ce9ed91"
      },
      "execution_count": 1,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "/content/mmdeploy\n",
            "/content/mmdeploy\n",
            "07/29 12:03:54 - mmengine - \u001b[4m\u001b[97mINFO\u001b[0m - Start pipeline mmdeploy.apis.pytorch2onnx.torch2onnx in subprocess\n",
            "07/29 12:03:57 - mmengine - \u001b[5m\u001b[4m\u001b[33mWARNING\u001b[0m - Failed to search registry with scope \"mmpose\" in the \"Codebases\" registry tree. As a workaround, the current \"Codebases\" registry in \"mmdeploy\" is used to build instance. This may cause unexpected failure when running the built modules. Please check whether \"mmpose\" is a correct scope, or whether the registry is initialized.\n",
            "07/29 12:03:57 - mmengine - \u001b[5m\u001b[4m\u001b[33mWARNING\u001b[0m - Failed to search registry with scope \"mmpose\" in the \"mmpose_tasks\" registry tree. As a workaround, the current \"mmpose_tasks\" registry in \"mmdeploy\" is used to build instance. This may cause unexpected failure when running the built modules. Please check whether \"mmpose\" is a correct scope, or whether the registry is initialized.\n",
            "Loads checkpoint by local backend from path: /content/dekr_hrnet-w32_8xb10-140e_coco-512x512_ac7c17bf-20221228.pth\n",
            "/content/mmpose/mmpose/datasets/datasets/utils.py:102: UserWarning: The metainfo config file \"configs/_base_/datasets/coco.py\" does not exist. A matched config file \"/content/mmpose/mmpose/.mim/configs/_base_/datasets/coco.py\" will be used instead.\n",
            "  warnings.warn(\n",
            "07/29 12:03:59 - mmengine - \u001b[5m\u001b[4m\u001b[33mWARNING\u001b[0m - DeprecationWarning: get_onnx_config will be deprecated in the future. \n",
            "07/29 12:03:59 - mmengine - \u001b[4m\u001b[97mINFO\u001b[0m - Export PyTorch model to ONNX: /content/quantized_dekr_model/end2end.onnx.\n",
            "/content/mmpose/mmpose/models/utils/ops.py:52: TracerWarning: Converting a tensor to a Python integer might cause the trace to be incorrect. We can't record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!\n",
            "  size = tuple(int(x) for x in size)\n",
            "/usr/local/lib/python3.11/dist-packages/mmcv/ops/deform_conv.py:333: TracerWarning: Converting a tensor to a Python boolean might cause the trace to be incorrect. We can't record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!\n",
            "  input_pad = (x.size(2) < self.kernel_size[0]) or (x.size(3) <\n",
            "/usr/local/lib/python3.11/dist-packages/mmcv/ops/deform_conv.py:335: TracerWarning: Converting a tensor to a Python boolean might cause the trace to be incorrect. We can't record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!\n",
            "  if input_pad:\n",
            "/usr/local/lib/python3.11/dist-packages/mmcv/ops/deform_conv.py:216: TracerWarning: Converting a tensor to a Python boolean might cause the trace to be incorrect. We can't record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!\n",
            "  if not all(map(lambda s: s > 0, output_size)):\n",
            "/usr/local/lib/python3.11/dist-packages/mmcv/ops/deform_conv.py:112: TracerWarning: Converting a tensor to a Python integer might cause the trace to be incorrect. We can't record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!\n",
            "  int(i)\n",
            "/usr/local/lib/python3.11/dist-packages/mmcv/ops/deform_conv.py:118: TracerWarning: Converting a tensor to a Python boolean might cause the trace to be incorrect. We can't record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!\n",
            "  cur_im2col_step = min(ctx.im2col_step, input.size(0))\n",
            "/usr/local/lib/python3.11/dist-packages/mmcv/ops/deform_conv.py:119: TracerWarning: Converting a tensor to a Python boolean might cause the trace to be incorrect. We can't record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!\n",
            "  assert (input.size(0) % cur_im2col_step\n",
            "/usr/local/lib/python3.11/dist-packages/mmcv/ops/deform_conv.py:344: TracerWarning: Converting a tensor to a Python boolean might cause the trace to be incorrect. We can't record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!\n",
            "  if input_pad:\n",
            "[W shape_type_inference.cpp:1920] Warning: The shape inference of mmdeploy::MMCVDeformConv2d type is missing, so it may result in wrong shape inference for the exported graph. Please consider adding it in symbolic function. (function UpdateReliable)\n",
            "[W shape_type_inference.cpp:1920] Warning: The shape inference of mmdeploy::MMCVDeformConv2d type is missing, so it may result in wrong shape inference for the exported graph. Please consider adding it in symbolic function. (function UpdateReliable)\n",
            "07/29 12:04:24 - mmengine - \u001b[4m\u001b[97mINFO\u001b[0m - Execute onnx optimize passes.\n",
            "07/29 12:04:24 - mmengine - \u001b[5m\u001b[4m\u001b[33mWARNING\u001b[0m - Can not optimize model, please build torchscipt extension.\n",
            "More details: https://github.com/open-mmlab/mmdeploy/tree/main/docs/en/experimental/onnx_optimizer.md\n",
            "============= Diagnostic Run torch.onnx.export version 2.0.1+cu118 =============\n",
            "verbose: False, log level: Level.ERROR\n",
            "======================= 0 NONE 0 NOTE 2 WARNING 0 ERROR ========================\n",
            "2 WARNING were not printed due to the log level.\n",
            "\n",
            "07/29 12:04:26 - mmengine - \u001b[4m\u001b[97mINFO\u001b[0m - Finish pipeline mmdeploy.apis.pytorch2onnx.torch2onnx\n",
            "07/29 12:04:27 - mmengine - \u001b[4m\u001b[97mINFO\u001b[0m - Start pipeline mmdeploy.apis.utils.utils.to_backend in main process\n",
            "07/29 12:04:27 - mmengine - \u001b[4m\u001b[97mINFO\u001b[0m - Finish pipeline mmdeploy.apis.utils.utils.to_backend\n",
            "07/29 12:04:27 - mmengine - \u001b[4m\u001b[97mINFO\u001b[0m - visualize onnxruntime model start.\n",
            "2025-07-29:12:04:31 - numexpr.utils - INFO - NumExpr defaulting to 2 threads.\n",
            "07/29 12:04:33 - mmengine - \u001b[5m\u001b[4m\u001b[33mWARNING\u001b[0m - Failed to search registry with scope \"mmpose\" in the \"Codebases\" registry tree. As a workaround, the current \"Codebases\" registry in \"mmdeploy\" is used to build instance. This may cause unexpected failure when running the built modules. Please check whether \"mmpose\" is a correct scope, or whether the registry is initialized.\n",
            "07/29 12:04:33 - mmengine - \u001b[5m\u001b[4m\u001b[33mWARNING\u001b[0m - Failed to search registry with scope \"mmpose\" in the \"mmpose_tasks\" registry tree. As a workaround, the current \"mmpose_tasks\" registry in \"mmdeploy\" is used to build instance. This may cause unexpected failure when running the built modules. Please check whether \"mmpose\" is a correct scope, or whether the registry is initialized.\n",
            "07/29 12:04:33 - mmengine - \u001b[5m\u001b[4m\u001b[33mWARNING\u001b[0m - Failed to search registry with scope \"mmpose\" in the \"backend_segmentors\" registry tree. As a workaround, the current \"backend_segmentors\" registry in \"mmdeploy\" is used to build instance. This may cause unexpected failure when running the built modules. Please check whether \"mmpose\" is a correct scope, or whether the registry is initialized.\n",
            "07/29 12:04:33 - mmengine - \u001b[4m\u001b[97mINFO\u001b[0m - Successfully loaded onnxruntime custom ops from /usr/local/lib/python3.11/dist-packages/mmdeploy/lib/libmmdeploy_onnxruntime_ops.so\n",
            "2025-07-29:12:04:33 - root - ERROR - class `End2EndModel` in mmdeploy/codebase/mmpose/deploy/pose_detection_model.py: [ONNXRuntimeError] : 1 : FAIL : Load model from /content/quantized_dekr_model/end2end.onnx failed:Fatal error: mmdeploy:MMCVDeformConv2d(-1) is not a registered function/op\n",
            "Traceback (most recent call last):\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmengine/registry/build_functions.py\", line 121, in build_from_cfg\n",
            "    obj = obj_cls(**args)  # type: ignore\n",
            "          ^^^^^^^^^^^^^^^\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmdeploy/codebase/mmpose/deploy/pose_detection_model.py\", line 51, in __init__\n",
            "    self._init_wrapper(\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmdeploy/codebase/mmpose/deploy/pose_detection_model.py\", line 71, in _init_wrapper\n",
            "    self.wrapper = BaseBackendModel._build_wrapper(\n",
            "                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmdeploy/codebase/base/backend_model.py\", line 65, in _build_wrapper\n",
            "    return backend_mgr.build_wrapper(backend_files, device, input_names,\n",
            "           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmdeploy/backend/onnxruntime/backend_manager.py\", line 35, in build_wrapper\n",
            "    return ORTWrapper(\n",
            "           ^^^^^^^^^^^\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmdeploy/backend/onnxruntime/wrapper.py\", line 63, in __init__\n",
            "    sess = ort.InferenceSession(\n",
            "           ^^^^^^^^^^^^^^^^^^^^^\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/onnxruntime/capi/onnxruntime_inference_collection.py\", line 419, in __init__\n",
            "    self._create_inference_session(providers, provider_options, disabled_optimizers)\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/onnxruntime/capi/onnxruntime_inference_collection.py\", line 472, in _create_inference_session\n",
            "    sess = C.InferenceSession(session_options, self._model_path, True, self._read_config_from_model)\n",
            "           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
            "onnxruntime.capi.onnxruntime_pybind11_state.Fail: [ONNXRuntimeError] : 1 : FAIL : Load model from /content/quantized_dekr_model/end2end.onnx failed:Fatal error: mmdeploy:MMCVDeformConv2d(-1) is not a registered function/op\n",
            "\n",
            "During handling of the above exception, another exception occurred:\n",
            "\n",
            "Traceback (most recent call last):\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmdeploy/utils/utils.py\", line 41, in target_wrapper\n",
            "    result = target(*args, **kwargs)\n",
            "             ^^^^^^^^^^^^^^^^^^^^^^^\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmdeploy/apis/visualize.py\", line 65, in visualize_model\n",
            "    model = task_processor.build_backend_model(\n",
            "            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmdeploy/codebase/mmpose/deploy/pose_detection.py\", line 173, in build_backend_model\n",
            "    model = build_pose_detection_model(\n",
            "            ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmdeploy/codebase/mmpose/deploy/pose_detection_model.py\", line 310, in build_pose_detection_model\n",
            "    backend_pose_model = __BACKEND_MODEL.build(\n",
            "                         ^^^^^^^^^^^^^^^^^^^^^^\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmengine/registry/registry.py\", line 545, in build\n",
            "    return self.build_func(cfg, *args, **kwargs, registry=self)\n",
            "           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmengine/registry/build_functions.py\", line 135, in build_from_cfg\n",
            "    raise type(e)(\n",
            "onnxruntime.capi.onnxruntime_pybind11_state.Fail: class `End2EndModel` in mmdeploy/codebase/mmpose/deploy/pose_detection_model.py: [ONNXRuntimeError] : 1 : FAIL : Load model from /content/quantized_dekr_model/end2end.onnx failed:Fatal error: mmdeploy:MMCVDeformConv2d(-1) is not a registered function/op\n",
            "07/29 12:04:34 - mmengine - \u001b[5m\u001b[4m\u001b[31mERROR\u001b[0m - /content/mmdeploy/tools/deploy.py - create_process - 82 - visualize onnxruntime model failed.\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "!python3 mmdeploy/tools/deploy.py configs/mmpose/pose-detection_onnx_static.py {MODEL_CONFIG} {MODEL_PATH} {WORK_DIR} --device cpu --backend onnx --input {TEST_IMAGE}"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "f0b5z9l6_HF-",
        "outputId": "57642c52-f30a-41b1-c4f4-280ab8e4d8fd"
      },
      "execution_count": 34,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "\n",
            "A module that was compiled using NumPy 1.x cannot be run in\n",
            "NumPy 2.2.6 as it may crash. To support both 1.x and 2.x\n",
            "versions of NumPy, modules must be compiled with NumPy 2.0.\n",
            "Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.\n",
            "\n",
            "If you are a user of the module, the easiest solution will be to\n",
            "downgrade to 'numpy<2' or try to upgrade the affected module.\n",
            "We expect that some modules will need time to support NumPy 2.\n",
            "\n",
            "Traceback (most recent call last):  File \"/content/mmdeploy/tools/deploy.py\", line 12, in <module>\n",
            "    from mmdeploy.apis import (create_calib_input_data, extract_model,\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmdeploy/apis/__init__.py\", line 7, in <module>\n",
            "    from .utils import build_task_processor, get_predefined_partition_cfg\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmdeploy/apis/utils/__init__.py\", line 3, in <module>\n",
            "    from .utils import (build_task_processor, get_predefined_partition_cfg,\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmdeploy/apis/utils/utils.py\", line 7, in <module>\n",
            "    from mmdeploy.codebase import BaseTask, get_codebase_class, import_codebase\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmdeploy/codebase/__init__.py\", line 5, in <module>\n",
            "    from .base import BaseTask, MMCodebase, get_codebase_class\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmdeploy/codebase/base/__init__.py\", line 2, in <module>\n",
            "    from .backend_model import BaseBackendModel\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmdeploy/codebase/base/backend_model.py\", line 6, in <module>\n",
            "    from mmengine.model import BaseModel\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmengine/model/__init__.py\", line 6, in <module>\n",
            "    from .base_model import BaseDataPreprocessor, BaseModel, ImgDataPreprocessor\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmengine/model/base_model/__init__.py\", line 2, in <module>\n",
            "    from .base_model import BaseModel\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmengine/model/base_model/base_model.py\", line 9, in <module>\n",
            "    from mmengine.optim import OptimWrapper\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmengine/optim/__init__.py\", line 2, in <module>\n",
            "    from .optimizer import (OPTIM_WRAPPER_CONSTRUCTORS, OPTIMIZERS,\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmengine/optim/optimizer/__init__.py\", line 9, in <module>\n",
            "    from .zero_optimizer import ZeroRedundancyOptimizer\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/mmengine/optim/optimizer/zero_optimizer.py\", line 11, in <module>\n",
            "    from torch.distributed.optim import \\\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/torch/distributed/optim/__init__.py\", line 30, in <module>\n",
            "    from .zero_redundancy_optimizer import ZeroRedundancyOptimizer\n",
            "  File \"/usr/local/lib/python3.11/dist-packages/torch/distributed/optim/zero_redundancy_optimizer.py\", line 74, in <module>\n",
            "    device: torch.device = torch.device(\"cpu\"),\n",
            "/usr/local/lib/python3.11/dist-packages/torch/distributed/optim/zero_redundancy_optimizer.py:74: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at ../torch/csrc/utils/tensor_numpy.cpp:84.)\n",
            "  device: torch.device = torch.device(\"cpu\"),\n",
            "usage: deploy.py [-h] [--test-img TEST_IMG [TEST_IMG ...]]\n",
            "                 [--work-dir WORK_DIR] [--calib-dataset-cfg CALIB_DATASET_CFG]\n",
            "                 [--device DEVICE]\n",
            "                 [--log-level {CRITICAL,FATAL,ERROR,WARN,WARNING,INFO,DEBUG,NOTSET}]\n",
            "                 [--show] [--dump-info] [--quant-image-dir QUANT_IMAGE_DIR]\n",
            "                 [--quant] [--uri URI]\n",
            "                 deploy_cfg model_cfg checkpoint img\n",
            "deploy.py: error: unrecognized arguments: --backend onnx --input /content/data/coco/images/val2017/000000000139.jpg\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from ppq import TargetPlatform\n",
        "print([platform for platform in dir(TargetPlatform) if not platform.startswith('_')])"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "ylQvSKJB9saG",
        "outputId": "36a7422f-308a-47cb-a121-44a0952bc5aa"
      },
      "execution_count": 16,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "['ASC_INT8', 'BF16', 'BOUNDARY', 'CAFFE', 'EXTENSION', 'FP16', 'FP32', 'FP8', 'FPGA_INT8', 'GRAPHCORE_FP8', 'HEXAGON_INT8', 'HOST_INT8', 'INT8', 'METAX_INT8_C', 'METAX_INT8_T', 'MNN_INT8', 'NATIVE', 'NCNN_INT8', 'NXP_INT8', 'ONNX', 'ONNXRUNTIME', 'OPENVINO_INT8', 'PPL_CUDA_FP16', 'PPL_CUDA_INT4', 'PPL_CUDA_INT8', 'PPL_CUDA_MIX', 'PPL_DSP_INT8', 'PPL_DSP_TI_INT8', 'QNN_DSP_INT8', 'RKNN_INT8', 'SNPE_INT8', 'SOI', 'TENGINE_INT8', 'TRT_FP8', 'TRT_INT8', 'UNSPECIFIED']\n"
          ]
        }
      ]
    }
  ],
  "metadata": {
    "accelerator": "GPU",
    "colab": {
      "provenance": [],
      "gpuType": "T4",
      "include_colab_link": true
    },
    "kernelspec": {
      "display_name": "Python 3",
      "name": "python3"
    },
    "language_info": {
      "codemirror_mode": {
        "name": "ipython",
        "version": 3
      },
      "file_extension": ".py",
      "mimetype": "text/x-python",
      "name": "python",
      "nbconvert_exporter": "python",
      "pygments_lexer": "ipython3",
      "version": "3.8.5"
    },
    "vscode": {
      "interpreter": {
        "hash": "383ba00087b5a9caebf3648b758a31e474cc01be975489b58f119fa4bc17e1f8"
      }
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}